[
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/README.md",
    "symbols": [],
    "snippet": "# AI Recruiter Backend\n\nA comprehensive **two-sided recruitment platform** that serves both **recruiters** and **job applicants** with AI-powered features, file management, and real-time chat assistance.\n\n## üöÄ Features\n\n### For Recruiters\n- **Dashboard Analytics** - Comprehensive metrics and insights\n- **Job Management** - Create, update, and manage job postings\n- **Candidate Management** - Track and filter candidates\n- **Interview Scheduling** - Schedule and manage interviews\n- **AI-Powered Evaluation** - AI assistance for candidate assessment\n- **Company Management** - Create and manage company profiles\n- **Team Management** - Add and manage team members\n\n### For Job Applicants\n- **Resume Upload & Parsing** - Upload and extract content from resumes\n- **AI Resume Generation** - Generate ",
    "snippetStartLine": 1,
    "snippetEndLine": 18,
    "chunks": [
      {
        "text": "# AI Recruiter Backend\n\nA comprehensive **two-sided recruitment platform** that serves both **recruiters** and **job applicants** with AI-powered features, file management, and real-time chat assistance.\n\n## üöÄ Features\n\n### For Recruiters\n- **Dashboard Analytics** - Comprehensive metrics and insights\n- **Job Management** - Create, update, and manage job postings\n- **Candidate Management** - Track and filter candidates\n- **Interview Scheduling** - Schedule and manage interviews\n- **AI-Powered Evaluation** - AI assistance for candidate assessment\n- **Company Management** - Create and manage com",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "aluation** - AI assistance for candidate assessment\n- **Company Management** - Create and manage company profiles\n- **Team Management** - Add and manage team members\n\n### For Job Applicants\n- **Resume Upload & Parsing** - Upload and extract content from resumes\n- **AI Resume Generation** - Generate tailored resumes using AI\n- **AI Cover Letter Generation** - Create personalized cover letters\n- **Job Analysis** - Analyze job postings from URLs or text\n- **PDF Export** - Export resumes and cover letters as PDFs\n- **AI Chat Assistant** - Get career guidance and interview tips\n\n### General Feature",
        "startLine": 12,
        "endLine": 24
      },
      {
        "text": "etters as PDFs\n- **AI Chat Assistant** - Get career guidance and interview tips\n\n### General Features\n- **User Authentication** - Secure login/registration with JWT\n- **File Management** - Upload, store, and manage files\n- **Real-time Chat** - AI-powered chat for career guidance\n- **Comprehensive Logging** - Detailed request and error logging\n- **API Documentation** - Interactive Swagger UI documentation\n- **Rate Limiting** - Protection against abuse\n- **Security Headers** - Helmet.js security middleware\n\n## üõ†Ô∏è Technology Stack\n\n- **Runtime**: Node.js with Express.js\n- **Database**: DigitalOc",
        "startLine": 21,
        "endLine": 36
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/aiController.js",
    "symbols": [],
    "snippet": "const aiProvider = require(\"../utils/aiProvider\");\nconst logger = require(\"../utils/logger\");\nconst axios = require(\"axios\");\nconst cheerio = require(\"cheerio\");\n\n// Helper function to extract job content from URL\nasync function extractJobFromUrl(jobUrl) {\n  try {\n    logger.info('Extracting job content from URL', { jobUrl });\n    \n    const response = await axios.get(jobUrl, {\n      headers: {\n  ",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "const aiProvider = require(\"../utils/aiProvider\");\nconst logger = require(\"../utils/logger\");\nconst axios = require(\"axios\");\nconst cheerio = require(\"cheerio\");\n\n// Helper function to extract job content from URL\nasync function extractJobFromUrl(jobUrl) {\n  try {\n    logger.info('Extracting job content from URL', { jobUrl });\n    \n    const response = await axios.get(jobUrl, {\n      headers: {",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "tent from URL', { jobUrl });\n    \n    const response = await axios.get(jobUrl, {\n      headers: {\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\n      },\n      timeout: 10000\n    });\n\n    const $ = cheerio.load(response.data);\n    \n    // Remove script and style elements\n    $('script, style').remove();",
        "startLine": 9,
        "endLine": 22
      },
      {
        "text": "oad(response.data);\n    \n    // Remove script and style elements\n    $('script, style').remove();\n    \n    // Extract text content\n    let jobContent = $('body').text();\n    \n    // Clean up the content\n    jobContent = jobContent\n      .replace(/\\s+/g, ' ')\n      .replace(/\\n+/g, '\\n')\n      .trim();\n    \n    // Try to find job-specific content\n    const jobSelectors = [\n      '[class*=\"job\"]',",
        "startLine": 18,
        "endLine": 35
      },
      {
        "text": ");\n    \n    // Try to find job-specific content\n    const jobSelectors = [\n      '[class*=\"job\"]',\n      '[class*=\"position\"]',\n      '[class*=\"description\"]',\n      '[id*=\"job\"]',\n      '[id*=\"position\"]',\n      '[id*=\"description\"]',\n      'main',\n      'article',\n      '.content',\n      '#content'\n    ];\n    \n    for (const selector of jobSelectors) {\n      const element = $(selector);\n      if",
        "startLine": 30,
        "endLine": 48
      },
      {
        "text": "'\n    ];\n    \n    for (const selector of jobSelectors) {\n      const element = $(selector);\n      if (element.length > 0) {\n        const elementText = element.text().trim();\n        if (elementText.length > 200) { // Minimum content threshold\n          jobContent = elementText;\n          break;\n        }\n      }\n    }\n    \n    logger.info('Job content extracted successfully', { \n      contentLeng",
        "startLine": 43,
        "endLine": 58
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/analyticsController.js",
    "symbols": [],
    "snippet": "const logger = require('../utils/logger');\nconst { db } = require('../utils/dbClient');\n\n// In-memory storage for rate limiting analytics (in production, use Redis)\nconst rateLimitStats = new Map();\n\nexports.getApiAnalytics = async (req, res, next) => {\n  try {\n    const { startDate, endDate, groupBy = 'day' } = req.query;\n    \n    logger.info('Fetching API analytics', { startDate, endDate, groupB",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const logger = require('../utils/logger');\nconst { db } = require('../utils/dbClient');\n\n// In-memory storage for rate limiting analytics (in production, use Redis)\nconst rateLimitStats = new Map();\n\nexports.getApiAnalytics = async (req, res, next) => {\n  try {\n    const { startDate, endDate, groupBy = 'day' } = req.query;\n    \n    logger.info('Fetching API analytics', { startDate, endDate, groupB",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "y = 'day' } = req.query;\n    \n    logger.info('Fetching API analytics', { startDate, endDate, groupBy });\n\n    // Get user statistics\n    const usersResult = await db.getCompanyUsers(null); // Get all users (we'll need a new method)\n    // For now, let's use a direct query approach\n    const { pool } = require('../utils/databaseClient');\n    const client = await pool.connect();\n    \n    try {",
        "startLine": 9,
        "endLine": 20
      },
      {
        "text": "} = require('../utils/databaseClient');\n    const client = await pool.connect();\n    \n    try {\n      const usersQuery = await client.query('SELECT id, created_at, role, is_pro FROM users');\n      const users = usersQuery.rows;\n\n      // Get job statistics\n      const jobsQuery = await client.query('SELECT id, created_at, status FROM jobs');\n      const jobs = jobsQuery.rows;\n\n      // Get candida",
        "startLine": 16,
        "endLine": 27
      },
      {
        "text": "'SELECT id, created_at, status FROM jobs');\n      const jobs = jobsQuery.rows;\n\n      // Get candidate statistics\n      const candidatesQuery = await client.query('SELECT id, created_at, status FROM candidates');\n      const candidates = candidatesQuery.rows;\n\n    // Calculate analytics\n    const analytics = {\n      users: {\n        total: users.length,\n        byRole: {\n          applicant: users",
        "startLine": 24,
        "endLine": 36
      },
      {
        "text": "alytics = {\n      users: {\n        total: users.length,\n        byRole: {\n          applicant: users.filter(u => u.role === 'applicant').length,\n          recruiter: users.filter(u => u.role === 'recruiter').length,\n          admin: users.filter(u => u.role === 'admin').length\n        },\n        proUsers: users.filter(u => u.is_pro).length\n      },\n      jobs: {\n        total: jobs.length,",
        "startLine": 32,
        "endLine": 44
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/applicantController.js",
    "symbols": [],
    "snippet": "const multer = require('multer');\nconst { v4: uuidv4 } = require('uuid');\nconst axios = require('axios');\nconst cheerio = require('cheerio');\nconst { db, storage, BUCKETS } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\nconst { log } = require('winston');\n\n// Configure multer for file uploads\nconst uploa",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const multer = require('multer');\nconst { v4: uuidv4 } = require('uuid');\nconst axios = require('axios');\nconst cheerio = require('cheerio');\nconst { db, storage, BUCKETS } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\nconst { log } = require('winston');\n\n// Configure multer for file uploads\nconst uploa",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "rrorHandler');\nconst { log } = require('winston');\n\n// Configure multer for file uploads\nconst upload = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: 10 * 1024 * 1024, // 10MB limit\n  },\n  fileFilter: (req, file, cb) => {\n    const allowedTypes = ['application/pdf', 'text/plain', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'",
        "startLine": 7,
        "endLine": 17
      },
      {
        "text": "in', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];\n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new ValidationError('Invalid file type. Only PDF, DOC, DOCX, and TXT files are allowed.'));\n    }\n  }\n});\n\n// Upload resume file\nexports.uploadResume = async (req, res, next) => {\n  const userId = req.user",
        "startLine": 17,
        "endLine": 28
      },
      {
        "text": "// Upload resume file\nexports.uploadResume = async (req, res, next) => {\n  const userId = req.user?.id;\n\n  try {\n    logger.info('Resume upload attempt', { userId });\n\n    if (!userId) {\n      throw new ValidationError('User not authenticated');\n    }\n\n    if (!req.file) {\n      throw new ValidationError('No file uploaded');\n    }\n\n    const file = req.file;\n    const fileId = uuidv4();\n    cons",
        "startLine": 24,
        "endLine": 43
      },
      {
        "text": "onError('No file uploaded');\n    }\n\n    const file = req.file;\n    const fileId = uuidv4();\n    const filePath = `${userId}/${fileId}_${file.originalname}`;\n\n    // Upload file to Supabase Storage\n    const uploadResult = await storage.uploadFile(\n      BUCKETS.RESUMES,\n      filePath,\n      file.buffer,\n      {\n        contentType: file.mimetype,\n        upsert: false\n      }\n    );\n\n    if (!upl",
        "startLine": 38,
        "endLine": 56
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/authController.js",
    "symbols": [],
    "snippet": "const jwt = require('jsonwebtoken');\nconst bcrypt = require('bcryptjs');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\nconst JWT_SECRET = process.env.JWT_SECRET;\n\nconst generateToken = (userId, role) => {\n  return jwt.sign(\n    { userId, role },\n    JWT_SECRET,\n    { expiresIn: '7d' }\n  );",
    "snippetStartLine": 1,
    "snippetEndLine": 14,
    "chunks": [
      {
        "text": "const jwt = require('jsonwebtoken');\nconst bcrypt = require('bcryptjs');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\nconst JWT_SECRET = process.env.JWT_SECRET;\n\nconst generateToken = (userId, role) => {\n  return jwt.sign(\n    { userId, role },\n    JWT_SECRET,\n    { expiresIn: '7d' }\n  );",
        "startLine": 1,
        "endLine": 14
      },
      {
        "text": "Id, role) => {\n  return jwt.sign(\n    { userId, role },\n    JWT_SECRET,\n    { expiresIn: '7d' }\n  );\n};\n\nexports.register = async (req, res, next) => {\n  const { email, password, firstName, lastName, role = 'applicant', company } = req.body;\n\n  try {\n    logger.info('User registration attempt', { email, role });\n\n    // Validate required fields\n    if (!email || !password || !firstName || !lastNam",
        "startLine": 9,
        "endLine": 24
      },
      {
        "text": "ail, role });\n\n    // Validate required fields\n    if (!email || !password || !firstName || !lastName) {\n      throw new ValidationError('Missing required fields: email, password, firstName, lastName');\n    }\n\n    const existingUser = await db.getUserByEmail(email);\n    if (existingUser.success && existingUser.data) {\n      throw new ValidationError('User with this email already exists');\n    }",
        "startLine": 21,
        "endLine": 33
      },
      {
        "text": "xistingUser.data) {\n      throw new ValidationError('User with this email already exists');\n    }\n\n    const saltRounds = 10;\n    const hashedPassword = await bcrypt.hash(password, saltRounds);\n\n    // Handle company creation for recruiters\n    let companyId = null;\n    if (role === 'recruiter' && company) {\n      // Check if company already exists\n      const existingCompanies = await db.getCompa",
        "startLine": 29,
        "endLine": 40
      },
      {
        "text": "ompany) {\n      // Check if company already exists\n      const existingCompanies = await db.getCompanies({ search: company.name });\n      if (existingCompanies.success && existingCompanies.data.length > 0) {\n        const existingCompany = existingCompanies.data.find(c => \n          c.name.toLowerCase() === company.name.toLowerCase()\n        );\n        if (existingCompany) {\n          companyId =",
        "startLine": 38,
        "endLine": 46
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/chatController.js",
    "symbols": [],
    "snippet": "const aiProvider = require('../utils/aiProvider');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Send message to AI chat\nexports.sendMessage = async (req, res, next) => {\n  const userId = req.user?.id;\n  const { message, context = 'general' } = req.body;\n\n  try {\n    logger.info('Chat m",
    "snippetStartLine": 1,
    "snippetEndLine": 12,
    "chunks": [
      {
        "text": "const aiProvider = require('../utils/aiProvider');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Send message to AI chat\nexports.sendMessage = async (req, res, next) => {\n  const userId = req.user?.id;\n  const { message, context = 'general' } = req.body;\n\n  try {\n    logger.info('Chat m",
        "startLine": 1,
        "endLine": 12
      },
      {
        "text": "req.user?.id;\n  const { message, context = 'general' } = req.body;\n\n  try {\n    logger.info('Chat message attempt', { userId, context });\n\n    if (!userId) {\n      throw new ValidationError('User not authenticated');\n    }\n\n    if (!message || message.trim().length === 0) {\n      throw new ValidationError('Message is required');\n    }\n\n    // Get chat history for context\n    const historyResult =",
        "startLine": 8,
        "endLine": 23
      },
      {
        "text": "onError('Message is required');\n    }\n\n    // Get chat history for context\n    const historyResult = await db.getChatHistory(userId, 10);\n    const chatHistory = historyResult.success ? historyResult.data : [];\n\n    // Build conversation context\n    const conversationHistory = chatHistory.map(msg => ({\n      role: msg.role,\n      content: msg.content\n    }));\n\n    // Add current message\n    conver",
        "startLine": 19,
        "endLine": 33
      },
      {
        "text": "({\n      role: msg.role,\n      content: msg.content\n    }));\n\n    // Add current message\n    conversationHistory.push({\n      role: 'user',\n      content: message\n    });\n\n    // Create system prompt based on context\n    let systemPrompt = \"You are a helpful AI assistant for job seekers and recruiters. Provide professional, accurate, and helpful advice.\";\n    \n    switch (context) {\n      case 'r",
        "startLine": 27,
        "endLine": 42
      },
      {
        "text": "ers. Provide professional, accurate, and helpful advice.\";\n    \n    switch (context) {\n      case 'resume':\n        systemPrompt = \"You are an expert resume writer and career coach. Help users improve their resumes, suggest better wording, and provide career advice.\";\n        break;\n      case 'interview':\n        systemPrompt = \"You are an interview preparation expert. Help users prepare for job",
        "startLine": 39,
        "endLine": 46
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/companyController.js",
    "symbols": [],
    "snippet": "const { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Create a new company\nexports.createCompany = async (req, res, next) => {\n  const { name, description, website, industry, size, location, foundedYear } = req.body;\n  const userId = req.user?.id;\n\n  try {\n    logger.info('Company creation atte",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Create a new company\nexports.createCompany = async (req, res, next) => {\n  const { name, description, website, industry, size, location, foundedYear } = req.body;\n  const userId = req.user?.id;\n\n  try {\n    logger.info('Company creation atte",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "dedYear } = req.body;\n  const userId = req.user?.id;\n\n  try {\n    logger.info('Company creation attempt', { name, userId });\n\n    // Validate required fields\n    if (!name) {\n      throw new ValidationError('Company name is required');\n    }\n\n    // Check if company already exists\n    const existingCompanies = await db.getCompanies({ search: name });\n    if (existingCompanies.success && existingCo",
        "startLine": 7,
        "endLine": 20
      },
      {
        "text": "Companies = await db.getCompanies({ search: name });\n    if (existingCompanies.success && existingCompanies.data.length > 0) {\n      const existingCompany = existingCompanies.data.find(company => \n        company.name.toLowerCase() === name.toLowerCase()\n      );\n      if (existingCompany) {\n        throw new ValidationError('Company with this name already exists');\n      }\n    }\n\n    // Create co",
        "startLine": 19,
        "endLine": 29
      },
      {
        "text": "throw new ValidationError('Company with this name already exists');\n      }\n    }\n\n    // Create company data\n    const companyData = {\n      name: name.trim(),\n      description: description?.trim(),\n      website: website?.trim(),\n      industry: industry?.trim(),\n      size: size,\n      location: location?.trim(),\n      founded_year: foundedYear,\n      created_at: new Date().toISOString()",
        "startLine": 25,
        "endLine": 39
      },
      {
        "text": ": location?.trim(),\n      founded_year: foundedYear,\n      created_at: new Date().toISOString()\n    };\n\n    const result = await db.createCompany(companyData);\n    if (!result.success) {\n      throw new Error(result.error);\n    }\n\n    // If user is creating the company, associate them with it\n    if (userId) {\n      await db.updateUser(userId, { company_id: result.data.id });\n    }\n\n    logger.inf",
        "startLine": 36,
        "endLine": 51
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/dashboardController.js",
    "symbols": [],
    "snippet": "const { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Get dashboard statistics\nexports.getDashboardStats = async (req, res, next) => {\n  const recruiterId = req.user?.id;\n\n  try {\n    logger.info('Getting dashboard stats', { recruiterId });\n\n    if (!recruiterId) {\n      throw new ValidationErr",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "const { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Get dashboard statistics\nexports.getDashboardStats = async (req, res, next) => {\n  const recruiterId = req.user?.id;\n\n  try {\n    logger.info('Getting dashboard stats', { recruiterId });\n\n    if (!recruiterId) {\n      throw new ValidationErr",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "('Getting dashboard stats', { recruiterId });\n\n    if (!recruiterId) {\n      throw new ValidationError('User not authenticated');\n    }\n\n    // Get jobs count\n    const jobsResult = await db.getJobs({ recruiter_id: recruiterId });\n    const totalJobs = jobsResult.success ? jobsResult.data.length : 0;\n    const activeJobs = jobsResult.success ? jobsResult.data.filter(job => job.status === 'active')",
        "startLine": 10,
        "endLine": 19
      },
      {
        "text": ";\n    const activeJobs = jobsResult.success ? jobsResult.data.filter(job => job.status === 'active').length : 0;\n\n    // Get candidates count\n    const candidatesResult = await db.getCandidates({ recruiter_id: recruiterId });\n    const totalCandidates = candidatesResult.success ? candidatesResult.data.length : 0;\n\n    // Get interviews count\n    const interviewsResult = await db.getInterviews({ re",
        "startLine": 18,
        "endLine": 26
      },
      {
        "text": "ta.length : 0;\n\n    // Get interviews count\n    const interviewsResult = await db.getInterviews({ recruiter_id: recruiterId });\n    const totalInterviews = interviewsResult.success ? interviewsResult.data.length : 0;\n    const upcomingInterviews = interviewsResult.success ? \n      interviewsResult.data.filter(interview => \n        new Date(interview.scheduled_at) > new Date() && interview.status =",
        "startLine": 23,
        "endLine": 30
      },
      {
        "text": "ata.filter(interview => \n        new Date(interview.scheduled_at) > new Date() && interview.status === 'scheduled'\n      ).length : 0;\n\n    // Calculate recent activity (last 30 days)\n    const thirtyDaysAgo = new Date();\n    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n\n    const recentJobs = jobsResult.success ? \n      jobsResult.data.filter(job => new Date(job.created_at) > thirtyDaysAg",
        "startLine": 29,
        "endLine": 38
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/fileController.js",
    "symbols": [],
    "snippet": "const multer = require('multer');\nconst { v4: uuidv4 } = require('uuid');\nconst { storage, db, BUCKETS } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Configure multer for general file uploads\nconst upload = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: 50 * 1024 * 1024, // 5",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const multer = require('multer');\nconst { v4: uuidv4 } = require('uuid');\nconst { storage, db, BUCKETS } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Configure multer for general file uploads\nconst upload = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: 50 * 1024 * 1024, // 5",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "pload = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: 50 * 1024 * 1024, // 50MB limit\n  },\n  fileFilter: (req, file, cb) => {\n    // Allow common file types\n    const allowedTypes = [\n      'application/pdf',\n      'text/plain',\n      'application/msword',\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n      'image/jpeg',\n      'image/png',",
        "startLine": 8,
        "endLine": 21
      },
      {
        "text": "vnd.openxmlformats-officedocument.wordprocessingml.document',\n      'image/jpeg',\n      'image/png',\n      'image/gif',\n      'application/zip',\n      'application/x-rar-compressed'\n    ];\n    \n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new ValidationError('Invalid file type. Please upload a supported file format.'));\n    }\n  }\n});\n\n// Upload file\ne",
        "startLine": 19,
        "endLine": 36
      },
      {
        "text": "Error('Invalid file type. Please upload a supported file format.'));\n    }\n  }\n});\n\n// Upload file\nexports.uploadFile = async (req, res, next) => {\n  const userId = req.user?.id;\n  const { category = 'general' } = req.body;\n\n  try {\n    logger.info('File upload attempt', { userId, category });\n\n    if (!userId) {\n      throw new ValidationError('User not authenticated');\n    }\n\n    if (!req.file)",
        "startLine": 30,
        "endLine": 47
      },
      {
        "text": "if (!userId) {\n      throw new ValidationError('User not authenticated');\n    }\n\n    if (!req.file) {\n      throw new ValidationError('No file uploaded');\n    }\n\n    const file = req.file;\n    const fileId = uuidv4();\n    const filePath = `${userId}/${category}/${fileId}_${file.originalname}`;\n\n    // Determine bucket based on category\n    let bucketName = BUCKETS.FILES;\n    if (category === 'resu",
        "startLine": 43,
        "endLine": 57
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/pdfController.js",
    "symbols": [],
    "snippet": "const pdfGenerator = require('../utils/pdfGenerator');\nconst logger = require('../utils/logger');\nconst fs = require('fs');\n\nexports.exportResumePDF = async (req, res, next) => {\n  const { content, format = 'A4' } = req.body;\n  \n  try {\n    logger.info('Exporting resume to PDF', { format });\n\n    const { filepath, filename } = await pdfGenerator.generateResumePDF(content, format);\n    \n    res.set",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "const pdfGenerator = require('../utils/pdfGenerator');\nconst logger = require('../utils/logger');\nconst fs = require('fs');\n\nexports.exportResumePDF = async (req, res, next) => {\n  const { content, format = 'A4' } = req.body;\n  \n  try {\n    logger.info('Exporting resume to PDF', { format });\n\n    const { filepath, filename } = await pdfGenerator.generateResumePDF(content, format);\n    \n    res.set",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "nst { filepath, filename } = await pdfGenerator.generateResumePDF(content, format);\n    \n    res.setHeader('Content-Type', 'application/pdf');\n    res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n    \n    const fileStream = fs.createReadStream(filepath);\n    fileStream.pipe(res);\n    \n    fileStream.on('end', () => {\n      pdfGenerator.cleanupTempFiles(filename);\n    });",
        "startLine": 11,
        "endLine": 21
      },
      {
        "text": "e(res);\n    \n    fileStream.on('end', () => {\n      pdfGenerator.cleanupTempFiles(filename);\n    });\n\n    fileStream.on('error', (error) => {\n      logger.error('Error streaming PDF file', { error: error.message, filename });\n      pdfGenerator.cleanupTempFiles(filename);\n      next(error);\n    });\n\n  } catch (error) {\n    logger.error('Error exporting resume PDF', {\n      error: error.message,",
        "startLine": 17,
        "endLine": 32
      },
      {
        "text": "} catch (error) {\n    logger.error('Error exporting resume PDF', {\n      error: error.message,\n      stack: error.stack\n    });\n    next(error);\n  }\n};\n\nexports.exportCoverLetterPDF = async (req, res, next) => {\n  const { content, format = 'A4' } = req.body;\n  \n  try {\n    logger.info('Exporting cover letter to PDF', { format });\n\n    const { filepath, filename } = await pdfGenerator.generateCo",
        "startLine": 28,
        "endLine": 44
      },
      {
        "text": "cover letter to PDF', { format });\n\n    const { filepath, filename } = await pdfGenerator.generateCoverLetterPDF(content, format);\n    \n    res.setHeader('Content-Type', 'application/pdf');\n    res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n    \n    const fileStream = fs.createReadStream(filepath);\n    fileStream.pipe(res);\n    \n    fileStream.on('end', () => {\n      p",
        "startLine": 42,
        "endLine": 53
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/docs/API_SUMMARY.md",
    "symbols": [],
    "snippet": "# AI Recruiter Backend API - Frontend Integration Guide\n\n## üöÄ **Quick Start**\n\n**Base URL**: `http://localhost:3001` (Development)  \n**API Version**: `/api/v1`  \n**Authentication**: Bearer Token (JWT)  \n**Content-Type**: `application/json`\n\n## üîê **Authentication**\n\n### Register User\n```http\nPOST /api/v1/auth/register\nContent-Type: application/json\n\n{\n  \"email\": \"user@example.com\",\n  \"password\": ",
    "snippetStartLine": 1,
    "snippetEndLine": 19,
    "chunks": [
      {
        "text": "# AI Recruiter Backend API - Frontend Integration Guide\n\n## üöÄ **Quick Start**\n\n**Base URL**: `http://localhost:3001` (Development)  \n**API Version**: `/api/v1`  \n**Authentication**: Bearer Token (JWT)  \n**Content-Type**: `application/json`\n\n## üîê **Authentication**\n\n### Register User\n```http\nPOST /api/v1/auth/register\nContent-Type: application/json\n\n{\n  \"email\": \"user@example.com\",\n  \"password\":",
        "startLine": 1,
        "endLine": 19
      },
      {
        "text": "api/v1/auth/register\nContent-Type: application/json\n\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"securePassword123\",\n  \"firstName\": \"John\",\n  \"lastName\": \"Doe\",\n  \"role\": \"applicant\", // or \"recruiter\"\n  \"company\": { // Required for recruiters\n    \"name\": \"Tech Corp\",\n    \"description\": \"A leading technology company\",\n    \"website\": \"https://techcorp.com\",\n    \"industry\": \"Technology\",\n    \"si",
        "startLine": 14,
        "endLine": 28
      },
      {
        "text": "ng technology company\",\n    \"website\": \"https://techcorp.com\",\n    \"industry\": \"Technology\",\n    \"size\": \"medium\",\n    \"location\": \"San Francisco, CA\",\n    \"foundedYear\": 2020\n  }\n}\n```\n\n**Response**:\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"user\": {\n      \"id\": \"user123\",\n      \"email\": \"user@example.com\",\n      \"firstName\": \"John\",\n      \"lastName\": \"Doe\",\n      \"role\": \"applicant\",\n      \"",
        "startLine": 25,
        "endLine": 46
      },
      {
        "text": "example.com\",\n      \"firstName\": \"John\",\n      \"lastName\": \"Doe\",\n      \"role\": \"applicant\",\n      \"companyId\": null\n    },\n    \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n  }\n}\n```\n\n### Login User\n```http\nPOST /api/v1/auth/login\nContent-Type: application/json\n\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"securePassword123\"\n}\n```\n\n**Response**:\n```json\n{\n  \"success\": true,\n  \"data\": {",
        "startLine": 42,
        "endLine": 69
      },
      {
        "text": ",\n  \"password\": \"securePassword123\"\n}\n```\n\n**Response**:\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"user\": {\n      \"id\": \"user123\",\n      \"email\": \"user@example.com\",\n      \"firstName\": \"John\",\n      \"lastName\": \"Doe\",\n      \"role\": \"applicant\"\n    },\n    \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n  }\n}\n```\n\n### Get Current User\n```http\nGET /api/v1/auth/me\nAuthorization: Bearer <token>",
        "startLine": 59,
        "endLine": 85
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/docs/ENDPOINTS_SUMMARY.md",
    "symbols": [],
    "snippet": "# AI Recruiter Backend - Endpoints Summary\n\n## üöÄ **Quick Reference**\n\n**Base URL**: `http://localhost:3001`  \n**API Version**: `/api/v1`  \n**Auth**: Bearer Token (JWT)\n\n## üìã **All Endpoints**\n\n### üîê **Authentication**\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| `POST` | `/api/v1/auth/register` | Register new user |\n| `POST` | `/api/v1/auth/login` | User login |\n| `",
    "snippetStartLine": 1,
    "snippetEndLine": 16,
    "chunks": [
      {
        "text": "# AI Recruiter Backend - Endpoints Summary\n\n## üöÄ **Quick Reference**\n\n**Base URL**: `http://localhost:3001`  \n**API Version**: `/api/v1`  \n**Auth**: Bearer Token (JWT)\n\n## üìã **All Endpoints**\n\n### üîê **Authentication**\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| `POST` | `/api/v1/auth/register` | Register new user |\n| `POST` | `/api/v1/auth/login` | User login |\n| `",
        "startLine": 1,
        "endLine": 16
      },
      {
        "text": "` | `/api/v1/auth/register` | Register new user |\n| `POST` | `/api/v1/auth/login` | User login |\n| `GET` | `/api/v1/auth/me` | Get current user |\n| `POST` | `/api/v1/auth/logout` | User logout |\n\n### üë§ **Applicant Features**\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| `POST` | `/api/v1/applicant/resumes/upload` | Upload resume |\n| `POST` | `/api/v1/applicant/resumes/",
        "startLine": 14,
        "endLine": 23
      },
      {
        "text": "`POST` | `/api/v1/applicant/resumes/upload` | Upload resume |\n| `POST` | `/api/v1/applicant/resumes/parse` | Parse resume content |\n| `POST` | `/api/v1/applicant/applications` | Apply for a job |\n| `GET` | `/api/v1/applicant/applications` | Get user's job applications |\n| `POST` | `/api/v1/applicant/ai/analyze-job` | Analyze job description |\n| `POST` | `/api/v1/applicant/ai/generate-resume` | Gen",
        "startLine": 22,
        "endLine": 27
      },
      {
        "text": "/ai/analyze-job` | Analyze job description |\n| `POST` | `/api/v1/applicant/ai/generate-resume` | Generate AI resume |\n| `POST` | `/api/v1/applicant/ai/generate-cover-letter` | Generate AI cover letter |\n| `POST` | `/api/v1/applicant/export/resume` | Export resume PDF |\n| `POST` | `/api/v1/applicant/export/cover-letter` | Export cover letter PDF |\n| `GET` | `/api/v1/applicant/interviews` | Get user",
        "startLine": 26,
        "endLine": 31
      },
      {
        "text": "export/cover-letter` | Export cover letter PDF |\n| `GET` | `/api/v1/applicant/interviews` | Get user interviews |\n| `POST` | `/api/v1/applicant/pro/signup` | Pro plan signup |\n\n### üíº **Recruiter Dashboard**\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| `GET` | `/api/v1/dashboard/stats` | Get dashboard statistics |\n| `GET` | `/api/v1/dashboard/jobs` | Get all jobs |\n| `",
        "startLine": 30,
        "endLine": 39
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/docs/ai-generation-features.md",
    "symbols": [],
    "snippet": "# AI Generation Features\n\n## Overview\n\nThe AI Recruiter platform uses OpenAI's GPT models to provide intelligent resume and cover letter generation, job analysis, and career guidance.\n\n## Features\n\n### 1. Resume Generation\n- **Smart Optimization**: AI analyzes job descriptions and optimizes resumes to match requirements\n- **Professional Formatting**: Clean, ATS-friendly formatting\n- **Customizable",
    "snippetStartLine": 1,
    "snippetEndLine": 12,
    "chunks": [
      {
        "text": "# AI Generation Features\n\n## Overview\n\nThe AI Recruiter platform uses OpenAI's GPT models to provide intelligent resume and cover letter generation, job analysis, and career guidance.\n\n## Features\n\n### 1. Resume Generation\n- **Smart Optimization**: AI analyzes job descriptions and optimizes resumes to match requirements\n- **Professional Formatting**: Clean, ATS-friendly formatting\n- **Customizable",
        "startLine": 1,
        "endLine": 12
      },
      {
        "text": "to match requirements\n- **Professional Formatting**: Clean, ATS-friendly formatting\n- **Customizable Styles**: Professional, creative, or minimalist styles\n- **Experience Enhancement**: Improves action verbs and quantifiable achievements\n\n### 2. Cover Letter Generation\n- **Personalized Content**: Tailored to specific job descriptions and candidate experience\n- **Professional Tone**: Appropriate fo",
        "startLine": 10,
        "endLine": 17
      },
      {
        "text": "ilored to specific job descriptions and candidate experience\n- **Professional Tone**: Appropriate for corporate environments\n- **Compelling Narratives**: Connects candidate experience to job requirements\n- **Call-to-Action**: Strong closing statements\n\n### 3. Job Analysis\n- **Skill Extraction**: Identifies key skills and requirements\n- **Experience Level Assessment**: Determines required experienc",
        "startLine": 16,
        "endLine": 23
      },
      {
        "text": "ntifies key skills and requirements\n- **Experience Level Assessment**: Determines required experience level\n- **Industry Insights**: Provides context about company and industry\n- **Growth Opportunities**: Highlights career advancement potential\n\n### 4. AI Chat Assistant\n- **Career Guidance**: Provides advice on job searching and career development\n- **Resume Tips**: Offers suggestions for resume i",
        "startLine": 22,
        "endLine": 29
      },
      {
        "text": "es advice on job searching and career development\n- **Resume Tips**: Offers suggestions for resume improvement\n- **Interview Preparation**: Helps with interview questions and strategies\n- **Industry Knowledge**: Shares insights about different industries\n\n## Technical Implementation\n\n### OpenAI Integration\n- **Model**: GPT-3.5-turbo (configurable to GPT-4)\n- **API**: OpenAI Chat Completions API\n-",
        "startLine": 28,
        "endLine": 38
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/jest.config.js",
    "symbols": [],
    "snippet": "module.exports = {\n  testEnvironment: 'node',\n  testMatch: ['**/__tests__/**/*.js', '**/?(*.)+(spec|test).js'],\n  collectCoverageFrom: [\n    'controllers/**/*.js',\n    'routes/**/*.js',\n    'utils/**/*.js',\n    'middleware/**/*.js',\n    '!**/node_modules/**',\n    '!**/coverage/**'\n  ],\n  coverageDirectory: 'coverage',\n  coverageReporters: ['text', 'lcov', 'html'],\n  setupFilesAfterEnv: ['<rootDir>",
    "snippetStartLine": 1,
    "snippetEndLine": 14,
    "chunks": [
      {
        "text": "module.exports = {\n  testEnvironment: 'node',\n  testMatch: ['**/__tests__/**/*.js', '**/?(*.)+(spec|test).js'],\n  collectCoverageFrom: [\n    'controllers/**/*.js',\n    'routes/**/*.js',\n    'utils/**/*.js',\n    'middleware/**/*.js',\n    '!**/node_modules/**',\n    '!**/coverage/**'\n  ],\n  coverageDirectory: 'coverage',\n  coverageReporters: ['text', 'lcov', 'html'],\n  setupFilesAfterEnv: ['<rootDir>",
        "startLine": 1,
        "endLine": 14
      },
      {
        "text": "ectory: 'coverage',\n  coverageReporters: ['text', 'lcov', 'html'],\n  setupFilesAfterEnv: ['<rootDir>/tests/setup.js'],\n  testTimeout: 10000,\n  verbose: true\n};",
        "startLine": 12,
        "endLine": 17
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/middleware/auth.js",
    "symbols": [],
    "snippet": "const jwt = require('jsonwebtoken');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\n\n// Middleware to authenticate JWT tokens\nconst authenticateToken = async (req, res, next) => {\n  try {\n    const authHeader = req.headers['authorization'];\n    const token = authHeader && authHeader.split(' ')[1]; // Bearer TOKEN\n\n    if (!token) {\n      return res.status(4",
    "snippetStartLine": 1,
    "snippetEndLine": 12,
    "chunks": [
      {
        "text": "const jwt = require('jsonwebtoken');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\n\n// Middleware to authenticate JWT tokens\nconst authenticateToken = async (req, res, next) => {\n  try {\n    const authHeader = req.headers['authorization'];\n    const token = authHeader && authHeader.split(' ')[1]; // Bearer TOKEN\n\n    if (!token) {\n      return res.status(4",
        "startLine": 1,
        "endLine": 12
      },
      {
        "text": "authHeader && authHeader.split(' ')[1]; // Bearer TOKEN\n\n    if (!token) {\n      return res.status(401).json({\n        success: false,\n        error: {\n          message: 'Access token is required'\n        }\n      });\n    }\n\n    // Verify JWT token\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\n    \n    // Get user from database\n    const userResult = await db.getUserById(decoded.u",
        "startLine": 9,
        "endLine": 24
      },
      {
        "text": "WT_SECRET);\n    \n    // Get user from database\n    const userResult = await db.getUserById(decoded.userId);\n\n    if (!userResult.success || !userResult.data) {\n      logger.warn('Invalid token - user not found', { userId: decoded.userId });\n      return res.status(401).json({\n        success: false,\n        error: {\n          message: 'Invalid or expired token'\n        }\n      });\n    }\n\n    const",
        "startLine": 21,
        "endLine": 36
      },
      {
        "text": "error: {\n          message: 'Invalid or expired token'\n        }\n      });\n    }\n\n    const user = userResult.data;\n\n    // Add user to request object\n    req.user = user;\n    next();\n\n  } catch (error) {\n    logger.error('Token verification failed:', error);\n    \n    if (error.name === 'JsonWebTokenError') {\n      return res.status(401).json({\n        success: false,\n        error: {",
        "startLine": 29,
        "endLine": 49
      },
      {
        "text": "onWebTokenError') {\n      return res.status(401).json({\n        success: false,\n        error: {\n          message: 'Invalid token'\n        }\n      });\n    }\n    \n    if (error.name === 'TokenExpiredError') {\n      return res.status(401).json({\n        success: false,\n        error: {\n          message: 'Token expired'\n        }\n      });\n    }\n\n    return res.status(500).json({\n      success: fal",
        "startLine": 45,
        "endLine": 64
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/middleware/errorHandler.js",
    "symbols": [],
    "snippet": "const logger = require('../utils/logger');\n\nconst errorHandler = (err, req, res, next) => {\n  logger.error('Error occurred:', {\n    error: err.message,\n    stack: err.stack,\n    url: req.url,\n    method: req.method,\n    ip: req.ip,\n    userAgent: req.get('User-Agent')\n  });\n\n  let error = {\n    message: 'Internal Server Error',\n    statusCode: 500\n  };\n\n  if (err.name === 'ValidationError') {\n    ",
    "snippetStartLine": 1,
    "snippetEndLine": 19,
    "chunks": [
      {
        "text": "const logger = require('../utils/logger');\n\nconst errorHandler = (err, req, res, next) => {\n  logger.error('Error occurred:', {\n    error: err.message,\n    stack: err.stack,\n    url: req.url,\n    method: req.method,\n    ip: req.ip,\n    userAgent: req.get('User-Agent')\n  });\n\n  let error = {\n    message: 'Internal Server Error',\n    statusCode: 500\n  };\n\n  if (err.name === 'ValidationError') {",
        "startLine": 1,
        "endLine": 19
      },
      {
        "text": "age: 'Internal Server Error',\n    statusCode: 500\n  };\n\n  if (err.name === 'ValidationError') {\n    error.message = 'Validation Error';\n    error.statusCode = 400;\n    error.details = err.details;\n  } else if (err.name === 'UnauthorizedError') {\n    error.message = 'Unauthorized';\n    error.statusCode = 401;\n  } else if (err.name === 'ForbiddenError') {\n    error.message = 'Forbidden';\n    error.s",
        "startLine": 14,
        "endLine": 27
      },
      {
        "text": "de = 401;\n  } else if (err.name === 'ForbiddenError') {\n    error.message = 'Forbidden';\n    error.statusCode = 403;\n  } else if (err.name === 'NotFoundError') {\n    error.message = 'Not Found';\n    error.statusCode = 404;\n  } else if (err.code === 'RATE_LIMIT_EXCEEDED') {\n    error.message = 'Too many requests';\n    error.statusCode = 429;\n  } else if (err.code === 'AI_API_ERROR') {\n    error.mes",
        "startLine": 24,
        "endLine": 35
      },
      {
        "text": "any requests';\n    error.statusCode = 429;\n  } else if (err.code === 'AI_API_ERROR') {\n    error.message = 'AI service temporarily unavailable';\n    error.statusCode = 503;\n  }\n\n  res.status(error.statusCode).json({\n    success: false,\n    error: {\n      message: error.message,\n      ...(process.env.NODE_ENV === 'development' && { stack: err.stack }),\n      ...(error.details && { details: error.de",
        "startLine": 32,
        "endLine": 44
      },
      {
        "text": ".NODE_ENV === 'development' && { stack: err.stack }),\n      ...(error.details && { details: error.details })\n    }\n  });\n};\n\nclass ValidationError extends Error {\n  constructor(message, details = null) {\n    super(message);\n    this.name = 'ValidationError';\n    this.details = details;\n  }\n}\n\nclass UnauthorizedError extends Error {\n  constructor(message = 'Unauthorized') {\n    super(message);",
        "startLine": 43,
        "endLine": 60
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/middleware/validation.js",
    "symbols": [],
    "snippet": "const { body, query, param, validationResult } = require('express-validator');\nconst { ValidationError } = require('./errorHandler');\n\n// Validation rules for resume generation\nconst validateResumeGeneration = [\n  body('resume')\n    .trim()\n    .notEmpty()\n    .withMessage('Resume content is required')\n    .isLength({ min: 50, max: 10000 })\n    .withMessage('Resume must be between 50 and 10,000 ch",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const { body, query, param, validationResult } = require('express-validator');\nconst { ValidationError } = require('./errorHandler');\n\n// Validation rules for resume generation\nconst validateResumeGeneration = [\n  body('resume')\n    .trim()\n    .notEmpty()\n    .withMessage('Resume content is required')\n    .isLength({ min: 50, max: 10000 })\n    .withMessage('Resume must be between 50 and 10,000 ch",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "d')\n    .isLength({ min: 50, max: 10000 })\n    .withMessage('Resume must be between 50 and 10,000 characters'),\n  \n  body('jobDescription')\n    .optional()\n    .trim()\n    .isLength({ min: 50, max: 10000 })\n    .withMessage('Job description must be between 50 and 10,000 characters'),\n  \n  body('jobUrl')\n    .optional()\n    .trim()\n    .isURL()\n    .withMessage('Job URL must be a valid URL'),",
        "startLine": 9,
        "endLine": 25
      },
      {
        "text": "rl')\n    .optional()\n    .trim()\n    .isURL()\n    .withMessage('Job URL must be a valid URL'),\n  \n  body('preferences')\n    .optional()\n    .isObject()\n    .withMessage('Preferences must be an object'),\n  \n  body('preferences.tone')\n    .optional()\n    .isIn(['professional', 'friendly', 'confident', 'enthusiastic'])\n    .withMessage('Tone must be one of: professional, friendly, confident, enthusia",
        "startLine": 19,
        "endLine": 33
      },
      {
        "text": "'enthusiastic'])\n    .withMessage('Tone must be one of: professional, friendly, confident, enthusiastic'),\n  \n  body('preferences.focus')\n    .optional()\n    .isArray()\n    .withMessage('Focus must be an array'),\n  \n  body('preferences.focus.*')\n    .optional()\n    .isString()\n    .withMessage('Focus items must be strings'),\n];\n\n// Validation rules for PDF export\nconst validatePdfExport = [\n  bod",
        "startLine": 32,
        "endLine": 48
      },
      {
        "text": "us items must be strings'),\n];\n\n// Validation rules for PDF export\nconst validatePdfExport = [\n  body('content')\n    .trim()\n    .notEmpty()\n    .withMessage('Content is required for PDF generation'),\n  \n  body('type')\n    .optional()\n    .isIn(['resume', 'cover-letter', 'both'])\n    .withMessage('Type must be one of: resume, cover-letter, both'),\n  \n  body('format')\n    .optional()\n    .isIn(['A4",
        "startLine": 43,
        "endLine": 60
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/README.md",
    "symbols": [],
    "snippet": "# AI Recruiter Backend\n\nA comprehensive **two-sided recruitment platform** that serves both **recruiters** and **job applicants** with AI-powered features, file management, and real-time chat assistance.\n\n## üöÄ Features\n\n### For Recruiters\n- **Dashboard Analytics** - Comprehensive metrics and insights\n- **Job Management** - Create, update, and manage job postings\n- **Candidate Management** - Track and filter candidates\n- **Interview Scheduling** - Schedule and manage interviews\n- **AI-Powered Evaluation** - AI assistance for candidate assessment\n- **Company Management** - Create and manage company profiles\n- **Team Management** - Add and manage team members\n\n### For Job Applicants\n- **Resume Upload & Parsing** - Upload and extract content from resumes\n- **AI Resume Generation** - Generate ",
    "snippetStartLine": 1,
    "snippetEndLine": 18,
    "chunks": [
      {
        "text": "# AI Recruiter Backend\n\nA comprehensive **two-sided recruitment platform** that serves both **recruiters** and **job applicants** with AI-powered features, file management, and real-time chat assistance.\n\n## üöÄ Features\n\n### For Recruiters\n- **Dashboard Analytics** - Comprehensive metrics and insights\n- **Job Management** - Create, update, and manage job postings\n- **Candidate Management** - Track and filter candidates\n- **Interview Scheduling** - Schedule and manage interviews\n- **AI-Powered Evaluation** - AI assistance for candidate assessment\n- **Company Management** - Create and manage com",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "aluation** - AI assistance for candidate assessment\n- **Company Management** - Create and manage company profiles\n- **Team Management** - Add and manage team members\n\n### For Job Applicants\n- **Resume Upload & Parsing** - Upload and extract content from resumes\n- **AI Resume Generation** - Generate tailored resumes using AI\n- **AI Cover Letter Generation** - Create personalized cover letters\n- **Job Analysis** - Analyze job postings from URLs or text\n- **PDF Export** - Export resumes and cover letters as PDFs\n- **AI Chat Assistant** - Get career guidance and interview tips\n\n### General Feature",
        "startLine": 12,
        "endLine": 24
      },
      {
        "text": "etters as PDFs\n- **AI Chat Assistant** - Get career guidance and interview tips\n\n### General Features\n- **User Authentication** - Secure login/registration with JWT\n- **File Management** - Upload, store, and manage files\n- **Real-time Chat** - AI-powered chat for career guidance\n- **Comprehensive Logging** - Detailed request and error logging\n- **API Documentation** - Interactive Swagger UI documentation\n- **Rate Limiting** - Protection against abuse\n- **Security Headers** - Helmet.js security middleware\n\n## üõ†Ô∏è Technology Stack\n\n- **Runtime**: Node.js with Express.js\n- **Database**: Supabase",
        "startLine": 21,
        "endLine": 36
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/aiController.js",
    "symbols": [],
    "snippet": "const aiProvider = require(\"../utils/aiProvider\");\nconst logger = require(\"../utils/logger\");\nconst axios = require(\"axios\");\nconst cheerio = require(\"cheerio\");\n\n// Helper function to extract job content from URL\nasync function extractJobFromUrl(jobUrl) {\n  try {\n    logger.info('Extracting job content from URL', { jobUrl });\n    \n    const response = await axios.get(jobUrl, {\n      headers: {\n  ",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "const aiProvider = require(\"../utils/aiProvider\");\nconst logger = require(\"../utils/logger\");\nconst axios = require(\"axios\");\nconst cheerio = require(\"cheerio\");\n\n// Helper function to extract job content from URL\nasync function extractJobFromUrl(jobUrl) {\n  try {\n    logger.info('Extracting job content from URL', { jobUrl });\n    \n    const response = await axios.get(jobUrl, {\n      headers: {",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "tent from URL', { jobUrl });\n    \n    const response = await axios.get(jobUrl, {\n      headers: {\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\n      },\n      timeout: 10000\n    });\n\n    const $ = cheerio.load(response.data);\n    \n    // Remove script and style elements\n    $('script, style').remove();",
        "startLine": 9,
        "endLine": 22
      },
      {
        "text": "oad(response.data);\n    \n    // Remove script and style elements\n    $('script, style').remove();\n    \n    // Extract text content\n    let jobContent = $('body').text();\n    \n    // Clean up the content\n    jobContent = jobContent\n      .replace(/\\s+/g, ' ')\n      .replace(/\\n+/g, '\\n')\n      .trim();\n    \n    // Try to find job-specific content\n    const jobSelectors = [\n      '[class*=\"job\"]',",
        "startLine": 18,
        "endLine": 35
      },
      {
        "text": ");\n    \n    // Try to find job-specific content\n    const jobSelectors = [\n      '[class*=\"job\"]',\n      '[class*=\"position\"]',\n      '[class*=\"description\"]',\n      '[id*=\"job\"]',\n      '[id*=\"position\"]',\n      '[id*=\"description\"]',\n      'main',\n      'article',\n      '.content',\n      '#content'\n    ];\n    \n    for (const selector of jobSelectors) {\n      const element = $(selector);\n      if",
        "startLine": 30,
        "endLine": 48
      },
      {
        "text": "'\n    ];\n    \n    for (const selector of jobSelectors) {\n      const element = $(selector);\n      if (element.length > 0) {\n        const elementText = element.text().trim();\n        if (elementText.length > 200) { // Minimum content threshold\n          jobContent = elementText;\n          break;\n        }\n      }\n    }\n    \n    logger.info('Job content extracted successfully', { \n      contentLeng",
        "startLine": 43,
        "endLine": 58
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/analyticsController.js",
    "symbols": [],
    "snippet": "const logger = require('../utils/logger');\nconst { db } = require('../utils/dbClient');\n\n// In-memory storage for rate limiting analytics (in production, use Redis)\nconst rateLimitStats = new Map();\n\nexports.getApiAnalytics = async (req, res, next) => {\n  try {\n    const { startDate, endDate, groupBy = 'day' } = req.query;\n    \n    logger.info('Fetching API analytics', { startDate, endDate, groupB",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const logger = require('../utils/logger');\nconst { db } = require('../utils/dbClient');\n\n// In-memory storage for rate limiting analytics (in production, use Redis)\nconst rateLimitStats = new Map();\n\nexports.getApiAnalytics = async (req, res, next) => {\n  try {\n    const { startDate, endDate, groupBy = 'day' } = req.query;\n    \n    logger.info('Fetching API analytics', { startDate, endDate, groupB",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "y = 'day' } = req.query;\n    \n    logger.info('Fetching API analytics', { startDate, endDate, groupBy });\n\n    // Get user statistics\n    const usersResult = await db.getCompanyUsers(null); // Get all users (we'll need a new method)\n    // For now, let's use a direct query approach\n    const { pool } = require('../utils/databaseClient');\n    const client = await pool.connect();\n    \n    try {",
        "startLine": 9,
        "endLine": 20
      },
      {
        "text": "} = require('../utils/databaseClient');\n    const client = await pool.connect();\n    \n    try {\n      const usersQuery = await client.query('SELECT id, created_at, role, is_pro FROM users');\n      const users = usersQuery.rows;\n\n      // Get job statistics\n      const jobsQuery = await client.query('SELECT id, created_at, status FROM jobs');\n      const jobs = jobsQuery.rows;\n\n      // Get candida",
        "startLine": 16,
        "endLine": 27
      },
      {
        "text": "'SELECT id, created_at, status FROM jobs');\n      const jobs = jobsQuery.rows;\n\n      // Get candidate statistics\n      const candidatesQuery = await client.query('SELECT id, created_at, status FROM candidates');\n      const candidates = candidatesQuery.rows;\n\n    // Calculate analytics\n    const analytics = {\n      users: {\n        total: users.length,\n        byRole: {\n          applicant: users",
        "startLine": 24,
        "endLine": 36
      },
      {
        "text": "alytics = {\n      users: {\n        total: users.length,\n        byRole: {\n          applicant: users.filter(u => u.role === 'applicant').length,\n          recruiter: users.filter(u => u.role === 'recruiter').length,\n          admin: users.filter(u => u.role === 'admin').length\n        },\n        proUsers: users.filter(u => u.is_pro).length\n      },\n      jobs: {\n        total: jobs.length,",
        "startLine": 32,
        "endLine": 44
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/applicantController.js",
    "symbols": [],
    "snippet": "const multer = require('multer');\nconst { v4: uuidv4 } = require('uuid');\nconst axios = require('axios');\nconst cheerio = require('cheerio');\nconst { db, storage, BUCKETS } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\nconst { log } = require('winston');\n\n// Configure multer for file uploads\nconst uploa",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const multer = require('multer');\nconst { v4: uuidv4 } = require('uuid');\nconst axios = require('axios');\nconst cheerio = require('cheerio');\nconst { db, storage, BUCKETS } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\nconst { log } = require('winston');\n\n// Configure multer for file uploads\nconst uploa",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "rrorHandler');\nconst { log } = require('winston');\n\n// Configure multer for file uploads\nconst upload = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: 10 * 1024 * 1024, // 10MB limit\n  },\n  fileFilter: (req, file, cb) => {\n    const allowedTypes = ['application/pdf', 'text/plain', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'",
        "startLine": 7,
        "endLine": 17
      },
      {
        "text": "in', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];\n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new ValidationError('Invalid file type. Only PDF, DOC, DOCX, and TXT files are allowed.'));\n    }\n  }\n});\n\n// Upload resume file\nexports.uploadResume = async (req, res, next) => {\n  const userId = req.user",
        "startLine": 17,
        "endLine": 28
      },
      {
        "text": "// Upload resume file\nexports.uploadResume = async (req, res, next) => {\n  const userId = req.user?.id;\n\n  try {\n    logger.info('Resume upload attempt', { userId });\n\n    if (!userId) {\n      throw new ValidationError('User not authenticated');\n    }\n\n    if (!req.file) {\n      throw new ValidationError('No file uploaded');\n    }\n\n    const file = req.file;\n    const fileId = uuidv4();\n    cons",
        "startLine": 24,
        "endLine": 43
      },
      {
        "text": "onError('No file uploaded');\n    }\n\n    const file = req.file;\n    const fileId = uuidv4();\n    const filePath = `${userId}/${fileId}_${file.originalname}`;\n\n    // Upload file to Supabase Storage\n    const uploadResult = await storage.uploadFile(\n      BUCKETS.RESUMES,\n      filePath,\n      file.buffer,\n      {\n        contentType: file.mimetype,\n        upsert: false\n      }\n    );\n\n    if (!upl",
        "startLine": 38,
        "endLine": 56
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/authController.js",
    "symbols": [],
    "snippet": "const jwt = require('jsonwebtoken');\nconst bcrypt = require('bcryptjs');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// JWT secret (in production, use environment variable)\nconst JWT_SECRET = process.env.JWT_SECRET;\n\n// Generate JWT token\nconst generateToken = (userId, role) => {\n  retur",
    "snippetStartLine": 1,
    "snippetEndLine": 12,
    "chunks": [
      {
        "text": "const jwt = require('jsonwebtoken');\nconst bcrypt = require('bcryptjs');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// JWT secret (in production, use environment variable)\nconst JWT_SECRET = process.env.JWT_SECRET;\n\n// Generate JWT token\nconst generateToken = (userId, role) => {\n  retur",
        "startLine": 1,
        "endLine": 12
      },
      {
        "text": "T = process.env.JWT_SECRET;\n\n// Generate JWT token\nconst generateToken = (userId, role) => {\n  return jwt.sign(\n    { userId, role },\n    JWT_SECRET,\n    { expiresIn: '7d' }\n  );\n};\n\n// User registration\nexports.register = async (req, res, next) => {\n  const { email, password, firstName, lastName, role = 'applicant', company } = req.body;\n\n  try {\n    logger.info('User registration attempt', { ema",
        "startLine": 8,
        "endLine": 24
      },
      {
        "text": "ole = 'applicant', company } = req.body;\n\n  try {\n    logger.info('User registration attempt', { email, role });\n\n    // Validate required fields\n    if (!email || !password || !firstName || !lastName) {\n      throw new ValidationError('Missing required fields: email, password, firstName, lastName');\n    }\n\n    // Check if user already exists by email\n    const existingUser = await db.getUserByEma",
        "startLine": 21,
        "endLine": 32
      },
      {
        "text": ";\n    }\n\n    // Check if user already exists by email\n    const existingUser = await db.getUserByEmail(email);\n    if (existingUser.success && existingUser.data) {\n      throw new ValidationError('User with this email already exists');\n    }\n\n    // Hash password\n    const saltRounds = 10;\n    const hashedPassword = await bcrypt.hash(password, saltRounds);\n\n    // Handle company creation for recru",
        "startLine": 28,
        "endLine": 41
      },
      {
        "text": "hashedPassword = await bcrypt.hash(password, saltRounds);\n\n    // Handle company creation for recruiters\n    let companyId = null;\n    if (role === 'recruiter' && company) {\n      // Check if company already exists\n      const existingCompanies = await db.getCompanies({ search: company.name });\n      if (existingCompanies.success && existingCompanies.data.length > 0) {\n        const existingCompa",
        "startLine": 39,
        "endLine": 47
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/chatController.js",
    "symbols": [],
    "snippet": "const aiProvider = require('../utils/aiProvider');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Send message to AI chat\nexports.sendMessage = async (req, res, next) => {\n  const userId = req.user?.id;\n  const { message, context = 'general' } = req.body;\n\n  try {\n    logger.info('Chat m",
    "snippetStartLine": 1,
    "snippetEndLine": 12,
    "chunks": [
      {
        "text": "const aiProvider = require('../utils/aiProvider');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Send message to AI chat\nexports.sendMessage = async (req, res, next) => {\n  const userId = req.user?.id;\n  const { message, context = 'general' } = req.body;\n\n  try {\n    logger.info('Chat m",
        "startLine": 1,
        "endLine": 12
      },
      {
        "text": "req.user?.id;\n  const { message, context = 'general' } = req.body;\n\n  try {\n    logger.info('Chat message attempt', { userId, context });\n\n    if (!userId) {\n      throw new ValidationError('User not authenticated');\n    }\n\n    if (!message || message.trim().length === 0) {\n      throw new ValidationError('Message is required');\n    }\n\n    // Get chat history for context\n    const historyResult =",
        "startLine": 8,
        "endLine": 23
      },
      {
        "text": "onError('Message is required');\n    }\n\n    // Get chat history for context\n    const historyResult = await db.getChatHistory(userId, 10);\n    const chatHistory = historyResult.success ? historyResult.data : [];\n\n    // Build conversation context\n    const conversationHistory = chatHistory.map(msg => ({\n      role: msg.role,\n      content: msg.content\n    }));\n\n    // Add current message\n    conver",
        "startLine": 19,
        "endLine": 33
      },
      {
        "text": "({\n      role: msg.role,\n      content: msg.content\n    }));\n\n    // Add current message\n    conversationHistory.push({\n      role: 'user',\n      content: message\n    });\n\n    // Create system prompt based on context\n    let systemPrompt = \"You are a helpful AI assistant for job seekers and recruiters. Provide professional, accurate, and helpful advice.\";\n    \n    switch (context) {\n      case 'r",
        "startLine": 27,
        "endLine": 42
      },
      {
        "text": "ers. Provide professional, accurate, and helpful advice.\";\n    \n    switch (context) {\n      case 'resume':\n        systemPrompt = \"You are an expert resume writer and career coach. Help users improve their resumes, suggest better wording, and provide career advice.\";\n        break;\n      case 'interview':\n        systemPrompt = \"You are an interview preparation expert. Help users prepare for job",
        "startLine": 39,
        "endLine": 46
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/companyController.js",
    "symbols": [],
    "snippet": "const { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Create a new company\nexports.createCompany = async (req, res, next) => {\n  const { name, description, website, industry, size, location, foundedYear } = req.body;\n  const userId = req.user?.id;\n\n  try {\n    logger.info('Company creation atte",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Create a new company\nexports.createCompany = async (req, res, next) => {\n  const { name, description, website, industry, size, location, foundedYear } = req.body;\n  const userId = req.user?.id;\n\n  try {\n    logger.info('Company creation atte",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "dedYear } = req.body;\n  const userId = req.user?.id;\n\n  try {\n    logger.info('Company creation attempt', { name, userId });\n\n    // Validate required fields\n    if (!name) {\n      throw new ValidationError('Company name is required');\n    }\n\n    // Check if company already exists\n    const existingCompanies = await db.getCompanies({ search: name });\n    if (existingCompanies.success && existingCo",
        "startLine": 7,
        "endLine": 20
      },
      {
        "text": "Companies = await db.getCompanies({ search: name });\n    if (existingCompanies.success && existingCompanies.data.length > 0) {\n      const existingCompany = existingCompanies.data.find(company => \n        company.name.toLowerCase() === name.toLowerCase()\n      );\n      if (existingCompany) {\n        throw new ValidationError('Company with this name already exists');\n      }\n    }\n\n    // Create co",
        "startLine": 19,
        "endLine": 29
      },
      {
        "text": "throw new ValidationError('Company with this name already exists');\n      }\n    }\n\n    // Create company data\n    const companyData = {\n      name: name.trim(),\n      description: description?.trim(),\n      website: website?.trim(),\n      industry: industry?.trim(),\n      size: size,\n      location: location?.trim(),\n      founded_year: foundedYear,\n      created_at: new Date().toISOString()",
        "startLine": 25,
        "endLine": 39
      },
      {
        "text": ": location?.trim(),\n      founded_year: foundedYear,\n      created_at: new Date().toISOString()\n    };\n\n    const result = await db.createCompany(companyData);\n    if (!result.success) {\n      throw new Error(result.error);\n    }\n\n    // If user is creating the company, associate them with it\n    if (userId) {\n      await db.updateUser(userId, { company_id: result.data.id });\n    }\n\n    logger.inf",
        "startLine": 36,
        "endLine": 51
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/dashboardController.js",
    "symbols": [],
    "snippet": "const { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Get dashboard statistics\nexports.getDashboardStats = async (req, res, next) => {\n  const recruiterId = req.user?.id;\n\n  try {\n    logger.info('Getting dashboard stats', { recruiterId });\n\n    if (!recruiterId) {\n      throw new ValidationErr",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "const { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Get dashboard statistics\nexports.getDashboardStats = async (req, res, next) => {\n  const recruiterId = req.user?.id;\n\n  try {\n    logger.info('Getting dashboard stats', { recruiterId });\n\n    if (!recruiterId) {\n      throw new ValidationErr",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "('Getting dashboard stats', { recruiterId });\n\n    if (!recruiterId) {\n      throw new ValidationError('User not authenticated');\n    }\n\n    // Get jobs count\n    const jobsResult = await db.getJobs({ recruiter_id: recruiterId });\n    const totalJobs = jobsResult.success ? jobsResult.data.length : 0;\n    const activeJobs = jobsResult.success ? jobsResult.data.filter(job => job.status === 'active')",
        "startLine": 10,
        "endLine": 19
      },
      {
        "text": ";\n    const activeJobs = jobsResult.success ? jobsResult.data.filter(job => job.status === 'active').length : 0;\n\n    // Get candidates count\n    const candidatesResult = await db.getCandidates({ recruiter_id: recruiterId });\n    const totalCandidates = candidatesResult.success ? candidatesResult.data.length : 0;\n\n    // Get interviews count\n    const interviewsResult = await db.getInterviews({ re",
        "startLine": 18,
        "endLine": 26
      },
      {
        "text": "ta.length : 0;\n\n    // Get interviews count\n    const interviewsResult = await db.getInterviews({ recruiter_id: recruiterId });\n    const totalInterviews = interviewsResult.success ? interviewsResult.data.length : 0;\n    const upcomingInterviews = interviewsResult.success ? \n      interviewsResult.data.filter(interview => \n        new Date(interview.scheduled_at) > new Date() && interview.status =",
        "startLine": 23,
        "endLine": 30
      },
      {
        "text": "ata.filter(interview => \n        new Date(interview.scheduled_at) > new Date() && interview.status === 'scheduled'\n      ).length : 0;\n\n    // Calculate recent activity (last 30 days)\n    const thirtyDaysAgo = new Date();\n    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n\n    const recentJobs = jobsResult.success ? \n      jobsResult.data.filter(job => new Date(job.created_at) > thirtyDaysAg",
        "startLine": 29,
        "endLine": 38
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/fileController.js",
    "symbols": [],
    "snippet": "const multer = require('multer');\nconst { v4: uuidv4 } = require('uuid');\nconst { storage, db, BUCKETS } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Configure multer for general file uploads\nconst upload = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: 50 * 1024 * 1024, // 5",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const multer = require('multer');\nconst { v4: uuidv4 } = require('uuid');\nconst { storage, db, BUCKETS } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\nconst { ValidationError } = require('../middleware/errorHandler');\n\n// Configure multer for general file uploads\nconst upload = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: 50 * 1024 * 1024, // 5",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "pload = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: 50 * 1024 * 1024, // 50MB limit\n  },\n  fileFilter: (req, file, cb) => {\n    // Allow common file types\n    const allowedTypes = [\n      'application/pdf',\n      'text/plain',\n      'application/msword',\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n      'image/jpeg',\n      'image/png',",
        "startLine": 8,
        "endLine": 21
      },
      {
        "text": "vnd.openxmlformats-officedocument.wordprocessingml.document',\n      'image/jpeg',\n      'image/png',\n      'image/gif',\n      'application/zip',\n      'application/x-rar-compressed'\n    ];\n    \n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new ValidationError('Invalid file type. Please upload a supported file format.'));\n    }\n  }\n});\n\n// Upload file\ne",
        "startLine": 19,
        "endLine": 36
      },
      {
        "text": "Error('Invalid file type. Please upload a supported file format.'));\n    }\n  }\n});\n\n// Upload file\nexports.uploadFile = async (req, res, next) => {\n  const userId = req.user?.id;\n  const { category = 'general' } = req.body;\n\n  try {\n    logger.info('File upload attempt', { userId, category });\n\n    if (!userId) {\n      throw new ValidationError('User not authenticated');\n    }\n\n    if (!req.file)",
        "startLine": 30,
        "endLine": 47
      },
      {
        "text": "if (!userId) {\n      throw new ValidationError('User not authenticated');\n    }\n\n    if (!req.file) {\n      throw new ValidationError('No file uploaded');\n    }\n\n    const file = req.file;\n    const fileId = uuidv4();\n    const filePath = `${userId}/${category}/${fileId}_${file.originalname}`;\n\n    // Determine bucket based on category\n    let bucketName = BUCKETS.FILES;\n    if (category === 'resu",
        "startLine": 43,
        "endLine": 57
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/controllers/pdfController.js",
    "symbols": [],
    "snippet": "const pdfGenerator = require('../utils/pdfGenerator');\nconst logger = require('../utils/logger');\nconst fs = require('fs');\n\nexports.exportResumePDF = async (req, res, next) => {\n  const { content, format = 'A4' } = req.body;\n  \n  try {\n    logger.info('Exporting resume to PDF', { format });\n\n    const { filepath, filename } = await pdfGenerator.generateResumePDF(content, format);\n    \n    res.set",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "const pdfGenerator = require('../utils/pdfGenerator');\nconst logger = require('../utils/logger');\nconst fs = require('fs');\n\nexports.exportResumePDF = async (req, res, next) => {\n  const { content, format = 'A4' } = req.body;\n  \n  try {\n    logger.info('Exporting resume to PDF', { format });\n\n    const { filepath, filename } = await pdfGenerator.generateResumePDF(content, format);\n    \n    res.set",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "nst { filepath, filename } = await pdfGenerator.generateResumePDF(content, format);\n    \n    res.setHeader('Content-Type', 'application/pdf');\n    res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n    \n    const fileStream = fs.createReadStream(filepath);\n    fileStream.pipe(res);\n    \n    fileStream.on('end', () => {\n      pdfGenerator.cleanupTempFiles(filename);\n    });",
        "startLine": 11,
        "endLine": 21
      },
      {
        "text": "e(res);\n    \n    fileStream.on('end', () => {\n      pdfGenerator.cleanupTempFiles(filename);\n    });\n\n    fileStream.on('error', (error) => {\n      logger.error('Error streaming PDF file', { error: error.message, filename });\n      pdfGenerator.cleanupTempFiles(filename);\n      next(error);\n    });\n\n  } catch (error) {\n    logger.error('Error exporting resume PDF', {\n      error: error.message,",
        "startLine": 17,
        "endLine": 32
      },
      {
        "text": "} catch (error) {\n    logger.error('Error exporting resume PDF', {\n      error: error.message,\n      stack: error.stack\n    });\n    next(error);\n  }\n};\n\nexports.exportCoverLetterPDF = async (req, res, next) => {\n  const { content, format = 'A4' } = req.body;\n  \n  try {\n    logger.info('Exporting cover letter to PDF', { format });\n\n    const { filepath, filename } = await pdfGenerator.generateCo",
        "startLine": 28,
        "endLine": 44
      },
      {
        "text": "cover letter to PDF', { format });\n\n    const { filepath, filename } = await pdfGenerator.generateCoverLetterPDF(content, format);\n    \n    res.setHeader('Content-Type', 'application/pdf');\n    res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n    \n    const fileStream = fs.createReadStream(filepath);\n    fileStream.pipe(res);\n    \n    fileStream.on('end', () => {\n      p",
        "startLine": 42,
        "endLine": 53
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/docs/API_SUMMARY.md",
    "symbols": [],
    "snippet": "# AI Recruiter Backend API - Frontend Integration Guide\n\n## üöÄ **Quick Start**\n\n**Base URL**: `http://localhost:3001` (Development)  \n**API Version**: `/api/v1`  \n**Authentication**: Bearer Token (JWT)  \n**Content-Type**: `application/json`\n\n## üîê **Authentication**\n\n### Register User\n```http\nPOST /api/v1/auth/register\nContent-Type: application/json\n\n{\n  \"email\": \"user@example.com\",\n  \"password\": ",
    "snippetStartLine": 1,
    "snippetEndLine": 19,
    "chunks": [
      {
        "text": "# AI Recruiter Backend API - Frontend Integration Guide\n\n## üöÄ **Quick Start**\n\n**Base URL**: `http://localhost:3001` (Development)  \n**API Version**: `/api/v1`  \n**Authentication**: Bearer Token (JWT)  \n**Content-Type**: `application/json`\n\n## üîê **Authentication**\n\n### Register User\n```http\nPOST /api/v1/auth/register\nContent-Type: application/json\n\n{\n  \"email\": \"user@example.com\",\n  \"password\":",
        "startLine": 1,
        "endLine": 19
      },
      {
        "text": "api/v1/auth/register\nContent-Type: application/json\n\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"securePassword123\",\n  \"firstName\": \"John\",\n  \"lastName\": \"Doe\",\n  \"role\": \"applicant\", // or \"recruiter\"\n  \"company\": { // Required for recruiters\n    \"name\": \"Tech Corp\",\n    \"description\": \"A leading technology company\",\n    \"website\": \"https://techcorp.com\",\n    \"industry\": \"Technology\",\n    \"si",
        "startLine": 14,
        "endLine": 28
      },
      {
        "text": "ng technology company\",\n    \"website\": \"https://techcorp.com\",\n    \"industry\": \"Technology\",\n    \"size\": \"medium\",\n    \"location\": \"San Francisco, CA\",\n    \"foundedYear\": 2020\n  }\n}\n```\n\n**Response**:\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"user\": {\n      \"id\": \"user123\",\n      \"email\": \"user@example.com\",\n      \"firstName\": \"John\",\n      \"lastName\": \"Doe\",\n      \"role\": \"applicant\",\n      \"",
        "startLine": 25,
        "endLine": 46
      },
      {
        "text": "example.com\",\n      \"firstName\": \"John\",\n      \"lastName\": \"Doe\",\n      \"role\": \"applicant\",\n      \"companyId\": null\n    },\n    \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n  }\n}\n```\n\n### Login User\n```http\nPOST /api/v1/auth/login\nContent-Type: application/json\n\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"securePassword123\"\n}\n```\n\n**Response**:\n```json\n{\n  \"success\": true,\n  \"data\": {",
        "startLine": 42,
        "endLine": 69
      },
      {
        "text": ",\n  \"password\": \"securePassword123\"\n}\n```\n\n**Response**:\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"user\": {\n      \"id\": \"user123\",\n      \"email\": \"user@example.com\",\n      \"firstName\": \"John\",\n      \"lastName\": \"Doe\",\n      \"role\": \"applicant\"\n    },\n    \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n  }\n}\n```\n\n### Get Current User\n```http\nGET /api/v1/auth/me\nAuthorization: Bearer <token>",
        "startLine": 59,
        "endLine": 85
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/docs/ENDPOINTS_SUMMARY.md",
    "symbols": [],
    "snippet": "# AI Recruiter Backend - Endpoints Summary\n\n## üöÄ **Quick Reference**\n\n**Base URL**: `http://localhost:3001`  \n**API Version**: `/api/v1`  \n**Auth**: Bearer Token (JWT)\n\n## üìã **All Endpoints**\n\n### üîê **Authentication**\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| `POST` | `/api/v1/auth/register` | Register new user |\n| `POST` | `/api/v1/auth/login` | User login |\n| `",
    "snippetStartLine": 1,
    "snippetEndLine": 16,
    "chunks": [
      {
        "text": "# AI Recruiter Backend - Endpoints Summary\n\n## üöÄ **Quick Reference**\n\n**Base URL**: `http://localhost:3001`  \n**API Version**: `/api/v1`  \n**Auth**: Bearer Token (JWT)\n\n## üìã **All Endpoints**\n\n### üîê **Authentication**\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| `POST` | `/api/v1/auth/register` | Register new user |\n| `POST` | `/api/v1/auth/login` | User login |\n| `",
        "startLine": 1,
        "endLine": 16
      },
      {
        "text": "` | `/api/v1/auth/register` | Register new user |\n| `POST` | `/api/v1/auth/login` | User login |\n| `GET` | `/api/v1/auth/me` | Get current user |\n| `POST` | `/api/v1/auth/logout` | User logout |\n\n### üë§ **Applicant Features**\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| `POST` | `/api/v1/applicant/resumes/upload` | Upload resume |\n| `POST` | `/api/v1/applicant/resumes/",
        "startLine": 14,
        "endLine": 23
      },
      {
        "text": "`POST` | `/api/v1/applicant/resumes/upload` | Upload resume |\n| `POST` | `/api/v1/applicant/resumes/parse` | Parse resume content |\n| `POST` | `/api/v1/applicant/applications` | Apply for a job |\n| `GET` | `/api/v1/applicant/applications` | Get user's job applications |\n| `POST` | `/api/v1/applicant/ai/analyze-job` | Analyze job description |\n| `POST` | `/api/v1/applicant/ai/generate-resume` | Gen",
        "startLine": 22,
        "endLine": 27
      },
      {
        "text": "/ai/analyze-job` | Analyze job description |\n| `POST` | `/api/v1/applicant/ai/generate-resume` | Generate AI resume |\n| `POST` | `/api/v1/applicant/ai/generate-cover-letter` | Generate AI cover letter |\n| `POST` | `/api/v1/applicant/export/resume` | Export resume PDF |\n| `POST` | `/api/v1/applicant/export/cover-letter` | Export cover letter PDF |\n| `GET` | `/api/v1/applicant/interviews` | Get user",
        "startLine": 26,
        "endLine": 31
      },
      {
        "text": "export/cover-letter` | Export cover letter PDF |\n| `GET` | `/api/v1/applicant/interviews` | Get user interviews |\n| `POST` | `/api/v1/applicant/pro/signup` | Pro plan signup |\n\n### üíº **Recruiter Dashboard**\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| `GET` | `/api/v1/dashboard/stats` | Get dashboard statistics |\n| `GET` | `/api/v1/dashboard/jobs` | Get all jobs |\n| `",
        "startLine": 30,
        "endLine": 39
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/docs/ai-generation-features.md",
    "symbols": [],
    "snippet": "# AI Generation Features\n\n## Overview\n\nThe AI Recruiter platform uses OpenAI's GPT models to provide intelligent resume and cover letter generation, job analysis, and career guidance.\n\n## Features\n\n### 1. Resume Generation\n- **Smart Optimization**: AI analyzes job descriptions and optimizes resumes to match requirements\n- **Professional Formatting**: Clean, ATS-friendly formatting\n- **Customizable",
    "snippetStartLine": 1,
    "snippetEndLine": 12,
    "chunks": [
      {
        "text": "# AI Generation Features\n\n## Overview\n\nThe AI Recruiter platform uses OpenAI's GPT models to provide intelligent resume and cover letter generation, job analysis, and career guidance.\n\n## Features\n\n### 1. Resume Generation\n- **Smart Optimization**: AI analyzes job descriptions and optimizes resumes to match requirements\n- **Professional Formatting**: Clean, ATS-friendly formatting\n- **Customizable",
        "startLine": 1,
        "endLine": 12
      },
      {
        "text": "to match requirements\n- **Professional Formatting**: Clean, ATS-friendly formatting\n- **Customizable Styles**: Professional, creative, or minimalist styles\n- **Experience Enhancement**: Improves action verbs and quantifiable achievements\n\n### 2. Cover Letter Generation\n- **Personalized Content**: Tailored to specific job descriptions and candidate experience\n- **Professional Tone**: Appropriate fo",
        "startLine": 10,
        "endLine": 17
      },
      {
        "text": "ilored to specific job descriptions and candidate experience\n- **Professional Tone**: Appropriate for corporate environments\n- **Compelling Narratives**: Connects candidate experience to job requirements\n- **Call-to-Action**: Strong closing statements\n\n### 3. Job Analysis\n- **Skill Extraction**: Identifies key skills and requirements\n- **Experience Level Assessment**: Determines required experienc",
        "startLine": 16,
        "endLine": 23
      },
      {
        "text": "ntifies key skills and requirements\n- **Experience Level Assessment**: Determines required experience level\n- **Industry Insights**: Provides context about company and industry\n- **Growth Opportunities**: Highlights career advancement potential\n\n### 4. AI Chat Assistant\n- **Career Guidance**: Provides advice on job searching and career development\n- **Resume Tips**: Offers suggestions for resume i",
        "startLine": 22,
        "endLine": 29
      },
      {
        "text": "es advice on job searching and career development\n- **Resume Tips**: Offers suggestions for resume improvement\n- **Interview Preparation**: Helps with interview questions and strategies\n- **Industry Knowledge**: Shares insights about different industries\n\n## Technical Implementation\n\n### OpenAI Integration\n- **Model**: GPT-3.5-turbo (configurable to GPT-4)\n- **API**: OpenAI Chat Completions API\n-",
        "startLine": 28,
        "endLine": 38
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/jest.config.js",
    "symbols": [],
    "snippet": "module.exports = {\n  testEnvironment: 'node',\n  testMatch: ['**/__tests__/**/*.js', '**/?(*.)+(spec|test).js'],\n  collectCoverageFrom: [\n    'controllers/**/*.js',\n    'routes/**/*.js',\n    'utils/**/*.js',\n    'middleware/**/*.js',\n    '!**/node_modules/**',\n    '!**/coverage/**'\n  ],\n  coverageDirectory: 'coverage',\n  coverageReporters: ['text', 'lcov', 'html'],\n  setupFilesAfterEnv: ['<rootDir>",
    "snippetStartLine": 1,
    "snippetEndLine": 14,
    "chunks": [
      {
        "text": "module.exports = {\n  testEnvironment: 'node',\n  testMatch: ['**/__tests__/**/*.js', '**/?(*.)+(spec|test).js'],\n  collectCoverageFrom: [\n    'controllers/**/*.js',\n    'routes/**/*.js',\n    'utils/**/*.js',\n    'middleware/**/*.js',\n    '!**/node_modules/**',\n    '!**/coverage/**'\n  ],\n  coverageDirectory: 'coverage',\n  coverageReporters: ['text', 'lcov', 'html'],\n  setupFilesAfterEnv: ['<rootDir>",
        "startLine": 1,
        "endLine": 14
      },
      {
        "text": "ectory: 'coverage',\n  coverageReporters: ['text', 'lcov', 'html'],\n  setupFilesAfterEnv: ['<rootDir>/tests/setup.js'],\n  testTimeout: 10000,\n  verbose: true\n};",
        "startLine": 12,
        "endLine": 17
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/middleware/auth.js",
    "symbols": [],
    "snippet": "const jwt = require('jsonwebtoken');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\n\n// Middleware to authenticate JWT tokens\nconst authenticateToken = async (req, res, next) => {\n  try {\n    const authHeader = req.headers['authorization'];\n    const token = authHeader && authHeader.split(' ')[1]; // Bearer TOKEN\n\n    if (!token) {\n      return res.status(4",
    "snippetStartLine": 1,
    "snippetEndLine": 12,
    "chunks": [
      {
        "text": "const jwt = require('jsonwebtoken');\nconst { db } = require('../utils/dbClient');\nconst logger = require('../utils/logger');\n\n// Middleware to authenticate JWT tokens\nconst authenticateToken = async (req, res, next) => {\n  try {\n    const authHeader = req.headers['authorization'];\n    const token = authHeader && authHeader.split(' ')[1]; // Bearer TOKEN\n\n    if (!token) {\n      return res.status(4",
        "startLine": 1,
        "endLine": 12
      },
      {
        "text": "authHeader && authHeader.split(' ')[1]; // Bearer TOKEN\n\n    if (!token) {\n      return res.status(401).json({\n        success: false,\n        error: {\n          message: 'Access token is required'\n        }\n      });\n    }\n\n    // Verify JWT token\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\n    \n    // Get user from database\n    const userResult = await db.getUserById(decoded.u",
        "startLine": 9,
        "endLine": 24
      },
      {
        "text": "WT_SECRET);\n    \n    // Get user from database\n    const userResult = await db.getUserById(decoded.userId);\n\n    if (!userResult.success || !userResult.data) {\n      logger.warn('Invalid token - user not found', { userId: decoded.userId });\n      return res.status(401).json({\n        success: false,\n        error: {\n          message: 'Invalid or expired token'\n        }\n      });\n    }\n\n    const",
        "startLine": 21,
        "endLine": 36
      },
      {
        "text": "error: {\n          message: 'Invalid or expired token'\n        }\n      });\n    }\n\n    const user = userResult.data;\n\n    // Add user to request object\n    req.user = user;\n    next();\n\n  } catch (error) {\n    logger.error('Token verification failed:', error);\n    \n    if (error.name === 'JsonWebTokenError') {\n      return res.status(401).json({\n        success: false,\n        error: {",
        "startLine": 29,
        "endLine": 49
      },
      {
        "text": "onWebTokenError') {\n      return res.status(401).json({\n        success: false,\n        error: {\n          message: 'Invalid token'\n        }\n      });\n    }\n    \n    if (error.name === 'TokenExpiredError') {\n      return res.status(401).json({\n        success: false,\n        error: {\n          message: 'Token expired'\n        }\n      });\n    }\n\n    return res.status(500).json({\n      success: fal",
        "startLine": 45,
        "endLine": 64
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/middleware/errorHandler.js",
    "symbols": [],
    "snippet": "const logger = require('../utils/logger');\n\nconst errorHandler = (err, req, res, next) => {\n  logger.error('Error occurred:', {\n    error: err.message,\n    stack: err.stack,\n    url: req.url,\n    method: req.method,\n    ip: req.ip,\n    userAgent: req.get('User-Agent')\n  });\n\n  let error = {\n    message: 'Internal Server Error',\n    statusCode: 500\n  };\n\n  if (err.name === 'ValidationError') {\n    ",
    "snippetStartLine": 1,
    "snippetEndLine": 19,
    "chunks": [
      {
        "text": "const logger = require('../utils/logger');\n\nconst errorHandler = (err, req, res, next) => {\n  logger.error('Error occurred:', {\n    error: err.message,\n    stack: err.stack,\n    url: req.url,\n    method: req.method,\n    ip: req.ip,\n    userAgent: req.get('User-Agent')\n  });\n\n  let error = {\n    message: 'Internal Server Error',\n    statusCode: 500\n  };\n\n  if (err.name === 'ValidationError') {",
        "startLine": 1,
        "endLine": 19
      },
      {
        "text": "age: 'Internal Server Error',\n    statusCode: 500\n  };\n\n  if (err.name === 'ValidationError') {\n    error.message = 'Validation Error';\n    error.statusCode = 400;\n    error.details = err.details;\n  } else if (err.name === 'UnauthorizedError') {\n    error.message = 'Unauthorized';\n    error.statusCode = 401;\n  } else if (err.name === 'ForbiddenError') {\n    error.message = 'Forbidden';\n    error.s",
        "startLine": 14,
        "endLine": 27
      },
      {
        "text": "de = 401;\n  } else if (err.name === 'ForbiddenError') {\n    error.message = 'Forbidden';\n    error.statusCode = 403;\n  } else if (err.name === 'NotFoundError') {\n    error.message = 'Not Found';\n    error.statusCode = 404;\n  } else if (err.code === 'RATE_LIMIT_EXCEEDED') {\n    error.message = 'Too many requests';\n    error.statusCode = 429;\n  } else if (err.code === 'AI_API_ERROR') {\n    error.mes",
        "startLine": 24,
        "endLine": 35
      },
      {
        "text": "any requests';\n    error.statusCode = 429;\n  } else if (err.code === 'AI_API_ERROR') {\n    error.message = 'AI service temporarily unavailable';\n    error.statusCode = 503;\n  }\n\n  res.status(error.statusCode).json({\n    success: false,\n    error: {\n      message: error.message,\n      ...(process.env.NODE_ENV === 'development' && { stack: err.stack }),\n      ...(error.details && { details: error.de",
        "startLine": 32,
        "endLine": 44
      },
      {
        "text": ".NODE_ENV === 'development' && { stack: err.stack }),\n      ...(error.details && { details: error.details })\n    }\n  });\n};\n\nclass ValidationError extends Error {\n  constructor(message, details = null) {\n    super(message);\n    this.name = 'ValidationError';\n    this.details = details;\n  }\n}\n\nclass UnauthorizedError extends Error {\n  constructor(message = 'Unauthorized') {\n    super(message);",
        "startLine": 43,
        "endLine": 60
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/middleware/validation.js",
    "symbols": [],
    "snippet": "const { body, query, param, validationResult } = require('express-validator');\nconst { ValidationError } = require('./errorHandler');\n\n// Validation rules for resume generation\nconst validateResumeGeneration = [\n  body('resume')\n    .trim()\n    .notEmpty()\n    .withMessage('Resume content is required')\n    .isLength({ min: 50, max: 10000 })\n    .withMessage('Resume must be between 50 and 10,000 ch",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const { body, query, param, validationResult } = require('express-validator');\nconst { ValidationError } = require('./errorHandler');\n\n// Validation rules for resume generation\nconst validateResumeGeneration = [\n  body('resume')\n    .trim()\n    .notEmpty()\n    .withMessage('Resume content is required')\n    .isLength({ min: 50, max: 10000 })\n    .withMessage('Resume must be between 50 and 10,000 ch",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "d')\n    .isLength({ min: 50, max: 10000 })\n    .withMessage('Resume must be between 50 and 10,000 characters'),\n  \n  body('jobDescription')\n    .optional()\n    .trim()\n    .isLength({ min: 50, max: 10000 })\n    .withMessage('Job description must be between 50 and 10,000 characters'),\n  \n  body('jobUrl')\n    .optional()\n    .trim()\n    .isURL()\n    .withMessage('Job URL must be a valid URL'),",
        "startLine": 9,
        "endLine": 25
      },
      {
        "text": "rl')\n    .optional()\n    .trim()\n    .isURL()\n    .withMessage('Job URL must be a valid URL'),\n  \n  body('preferences')\n    .optional()\n    .isObject()\n    .withMessage('Preferences must be an object'),\n  \n  body('preferences.tone')\n    .optional()\n    .isIn(['professional', 'friendly', 'confident', 'enthusiastic'])\n    .withMessage('Tone must be one of: professional, friendly, confident, enthusia",
        "startLine": 19,
        "endLine": 33
      },
      {
        "text": "'enthusiastic'])\n    .withMessage('Tone must be one of: professional, friendly, confident, enthusiastic'),\n  \n  body('preferences.focus')\n    .optional()\n    .isArray()\n    .withMessage('Focus must be an array'),\n  \n  body('preferences.focus.*')\n    .optional()\n    .isString()\n    .withMessage('Focus items must be strings'),\n];\n\n// Validation rules for PDF export\nconst validatePdfExport = [\n  bod",
        "startLine": 32,
        "endLine": 48
      },
      {
        "text": "us items must be strings'),\n];\n\n// Validation rules for PDF export\nconst validatePdfExport = [\n  body('content')\n    .trim()\n    .notEmpty()\n    .withMessage('Content is required for PDF generation'),\n  \n  body('type')\n    .optional()\n    .isIn(['resume', 'cover-letter', 'both'])\n    .withMessage('Type must be one of: resume, cover-letter, both'),\n  \n  body('format')\n    .optional()\n    .isIn(['A4",
        "startLine": 43,
        "endLine": 60
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/package.json",
    "symbols": [
      "name",
      "version",
      "main",
      "scripts",
      "test",
      "test:watch",
      "test:coverage",
      "test:db",
      "dev",
      "start",
      "migrate",
      "migrate:reset",
      "keywords",
      "0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "author",
      "license",
      "description",
      "dependencies",
      "aws-sdk",
      "axios",
      "bcryptjs",
      "cheerio",
      "cors",
      "dotenv",
      "express",
      "express-rate-limit",
      "express-validator",
      "helmet",
      "jsonwebtoken",
      "mammoth",
      "multer",
      "node-cron",
      "pdf-parse",
      "pdf.js-extract",
      "pdf2pic",
      "pdfkit",
      "pg",
      "playwright",
      "swagger-ui-express",
      "uuid",
      "winston",
      "yamljs",
      "devDependencies",
      "jest",
      "nodemon",
      "supertest"
    ],
    "snippet": "{\n  \"name\": \"ai-recruiter-backend\",\n  \"version\": \"1.0.0\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"jest\",\n    \"test:watch\": \"jest --watch\",\n    \"test:coverage\": \"jest --coverage\",\n    \"test:db\": \"node scripts/test-db-connection.js\",\n    \"dev\": \"nodemon server.js\",\n    \"start\": \"node server.js\",\n    \"migrate\": \"node scripts/migrate.js\",\n    \"migrate:reset\": \"node scripts/migrate.js --reset\"\n  },\n  \"keywords\": [\n    \"ai\",\n    \"recruiter\",\n    \"resume\",\n    \"cover-letter\",\n    \"job-applicant\",\n    \"recruitment\"\n  ],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"description\": \"AI-powered recruitment platform with two-sided marketplace (Recruiters & Job Applicants)\",\n  \"dependencies\": {\n    \"aws-sdk\": \"^2.1691.0\",\n    \"axios\": \"^1.6.0\",\n    \"bcryptjs\": \"^2.4.3\",\n    \"cheerio\": \"^1.1.0\",\n    \"",
    "snippetStartLine": 1,
    "snippetEndLine": 31,
    "chunks": [
      {
        "text": "{\n  \"name\": \"ai-recruiter-backend\",\n  \"version\": \"1.0.0\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"jest\",\n    \"test:watch\": \"jest --watch\",\n    \"test:coverage\": \"jest --coverage\",\n    \"test:db\": \"node scripts/test-db-connection.js\",\n    \"dev\": \"nodemon server.js\",\n    \"start\": \"node server.js\",\n    \"migrate\": \"node scripts/migrate.js\",\n    \"migrate:reset\": \"node scripts/migrate.js --reset\"\n  },\n  \"keywords\": [\n    \"ai\",\n    \"recruiter\",\n    \"resume\",\n    \"cover-letter\",\n    \"job-applicant\",\n    \"recruitment\"\n  ],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"description\": \"AI-powered recruit",
        "startLine": 1,
        "endLine": 25
      },
      {
        "text": "nt\",\n    \"recruitment\"\n  ],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"description\": \"AI-powered recruitment platform with two-sided marketplace (Recruiters & Job Applicants)\",\n  \"dependencies\": {\n    \"aws-sdk\": \"^2.1691.0\",\n    \"axios\": \"^1.6.0\",\n    \"bcryptjs\": \"^2.4.3\",\n    \"cheerio\": \"^1.1.0\",\n    \"cors\": \"^2.8.5\",\n    \"dotenv\": \"^17.0.1\",\n    \"express\": \"^4.18.2\",\n    \"express-rate-limit\": \"^7.4.1\",\n    \"express-validator\": \"^7.0.1\",\n    \"helmet\": \"^8.0.0\",\n    \"jsonwebtoken\": \"^9.0.2\",\n    \"mammoth\": \"^1.9.1\",\n    \"multer\": \"^1.4.5-lts.1\",\n    \"node-cron\": \"^3.0.3\",\n    \"pdf-parse\": \"^1.1.1\"",
        "startLine": 20,
        "endLine": 41
      },
      {
        "text": "mmoth\": \"^1.9.1\",\n    \"multer\": \"^1.4.5-lts.1\",\n    \"node-cron\": \"^3.0.3\",\n    \"pdf-parse\": \"^1.1.1\",\n    \"pdf.js-extract\": \"^0.2.1\",\n    \"pdf2pic\": \"^3.2.0\",\n    \"pdfkit\": \"^0.15.0\",\n    \"pg\": \"^8.12.0\",\n    \"playwright\": \"^1.53.2\",\n    \"swagger-ui-express\": \"^4.6.3\",\n    \"uuid\": \"^9.0.1\",\n    \"winston\": \"^3.15.0\",\n    \"yamljs\": \"^0.3.0\"\n  },\n  \"devDependencies\": {\n    \"jest\": \"^29.7.0\",\n    \"nodemon\": \"^3.1.10\",\n    \"supertest\": \"^6.3.4\"\n  }\n}",
        "startLine": 38,
        "endLine": 58
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/scripts/migrate.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst fs = require('fs');\nconst path = require('path');\nconst { pool } = require('../utils/databaseClient');\nconst logger = require('../utils/logger');\n\nclass MigrationRunner {\n  constructor() {\n    this.migrationsDir = path.join(__dirname, '../migrations');\n    this.migrations = [];\n  }\n\n  async loadMigrations() {\n    try {\n      const files = fs.readdirSync(this.migra",
    "snippetStartLine": 1,
    "snippetEndLine": 15,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst fs = require('fs');\nconst path = require('path');\nconst { pool } = require('../utils/databaseClient');\nconst logger = require('../utils/logger');\n\nclass MigrationRunner {\n  constructor() {\n    this.migrationsDir = path.join(__dirname, '../migrations');\n    this.migrations = [];\n  }\n\n  async loadMigrations() {\n    try {\n      const files = fs.readdirSync(this.migra",
        "startLine": 1,
        "endLine": 15
      },
      {
        "text": "ations = [];\n  }\n\n  async loadMigrations() {\n    try {\n      const files = fs.readdirSync(this.migrationsDir)\n        .filter(file => file.endsWith('.sql'))\n        .sort();\n\n      for (const file of files) {\n        const migrationPath = path.join(this.migrationsDir, file);\n        const sql = fs.readFileSync(migrationPath, 'utf8');\n        \n        this.migrations.push({\n          name: file,",
        "startLine": 10,
        "endLine": 25
      },
      {
        "text": "eadFileSync(migrationPath, 'utf8');\n        \n        this.migrations.push({\n          name: file,\n          sql: sql\n        });\n      }\n\n      logger.info(`Loaded ${this.migrations.length} migrations`);\n      return this.migrations;\n    } catch (error) {\n      logger.error('Error loading migrations:', error);\n      throw error;\n    }\n  }\n\n  async createMigrationsTable() {\n    const client = await",
        "startLine": 21,
        "endLine": 38
      },
      {
        "text": ":', error);\n      throw error;\n    }\n  }\n\n  async createMigrationsTable() {\n    const client = await pool.connect();\n    try {\n      // Create migrations table if it doesn't exist\n      await client.query(`\n        CREATE TABLE IF NOT EXISTS migrations (\n          id SERIAL PRIMARY KEY,\n          name VARCHAR(255) UNIQUE NOT NULL,\n          executed_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()",
        "startLine": 32,
        "endLine": 46
      },
      {
        "text": "me VARCHAR(255) UNIQUE NOT NULL,\n          executed_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        )\n      `);\n      logger.info('Migrations table ready');\n    } catch (error) {\n      logger.error('Error creating migrations table:', error);\n      throw error;\n    } finally {\n      client.release();\n    }\n  }\n\n  async getExecutedMigrations() {\n    const client = await pool.connect();\n    try {",
        "startLine": 44,
        "endLine": 60
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/scripts/sync-users.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst { supabaseAdmin } = require('../utils/supabaseClient');\nconst logger = require('../utils/logger');\n\nasync function syncExistingUsers() {\n  try {\n    console.log('üîÑ Starting user sync process...');\n\n    // Get all auth users\n    const { data: authUsers, error: authError } = await supabaseAdmin.auth.admin.listUsers();\n    \n    if (authError) {\n      throw new Error",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst { supabaseAdmin } = require('../utils/supabaseClient');\nconst logger = require('../utils/logger');\n\nasync function syncExistingUsers() {\n  try {\n    console.log('üîÑ Starting user sync process...');\n\n    // Get all auth users\n    const { data: authUsers, error: authError } = await supabaseAdmin.auth.admin.listUsers();\n    \n    if (authError) {\n      throw new Error",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "rror } = await supabaseAdmin.auth.admin.listUsers();\n    \n    if (authError) {\n      throw new Error(`Failed to get auth users: ${authError.message}`);\n    }\n\n    console.log(`üìä Found ${authUsers.users.length} users in Supabase Auth`);\n\n    // Get existing users in the users table\n    const { data: existingUsers, error: dbError } = await supabaseAdmin\n      .from('users')\n      .select('id, email",
        "startLine": 10,
        "endLine": 21
      },
      {
        "text": "existingUsers, error: dbError } = await supabaseAdmin\n      .from('users')\n      .select('id, email');\n\n    if (dbError) {\n      throw new Error(`Failed to get existing users: ${dbError.message}`);\n    }\n\n    console.log(`üìä Found ${existingUsers.length} users in users table`);\n\n    const existingUserIds = new Set(existingUsers.map(u => u.id));\n    const usersToCreate = [];\n\n    // Find users tha",
        "startLine": 19,
        "endLine": 32
      },
      {
        "text": "serIds = new Set(existingUsers.map(u => u.id));\n    const usersToCreate = [];\n\n    // Find users that exist in auth but not in users table\n    for (const authUser of authUsers.users) {\n      if (!existingUserIds.has(authUser.id)) {\n        usersToCreate.push({\n          id: authUser.id,\n          email: authUser.email,\n          first_name: authUser.user_metadata?.first_name || '',\n          last_",
        "startLine": 29,
        "endLine": 39
      },
      {
        "text": "ail: authUser.email,\n          first_name: authUser.user_metadata?.first_name || '',\n          last_name: authUser.user_metadata?.last_name || '',\n          role: authUser.user_metadata?.role || 'applicant',\n          created_at: authUser.created_at,\n          updated_at: authUser.updated_at\n        });\n      }\n    }\n\n    console.log(`üÜï Found ${usersToCreate.length} users to sync`);\n\n    if (user",
        "startLine": 37,
        "endLine": 49
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/scripts/test-db-connection.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst { testConnection, db, pool } = require('../utils/databaseClient');\nconst logger = require('../utils/logger');\n\nasync function testDatabaseConnection() {\n  console.log('üîç Testing database connection...\\n');\n  \n  try {\n    // Test environment variables\n    const requiredEnvVars = ['DATABASE_URL'];\n    const hasDbUrl = !!process.env.DATABASE_URL;\n    const hasDbPara",
    "snippetStartLine": 1,
    "snippetEndLine": 12,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst { testConnection, db, pool } = require('../utils/databaseClient');\nconst logger = require('../utils/logger');\n\nasync function testDatabaseConnection() {\n  console.log('üîç Testing database connection...\\n');\n  \n  try {\n    // Test environment variables\n    const requiredEnvVars = ['DATABASE_URL'];\n    const hasDbUrl = !!process.env.DATABASE_URL;\n    const hasDbPara",
        "startLine": 1,
        "endLine": 12
      },
      {
        "text": "iredEnvVars = ['DATABASE_URL'];\n    const hasDbUrl = !!process.env.DATABASE_URL;\n    const hasDbParams = process.env.DB_HOST && process.env.DB_USER && process.env.DB_PASSWORD;\n    \n    if (!hasDbUrl && !hasDbParams) {\n      console.log('‚ùå Missing database configuration!');\n      console.log('   Please set either DATABASE_URL or DB_HOST/DB_USER/DB_PASSWORD in your .env file');\n      process.exit(1)",
        "startLine": 10,
        "endLine": 17
      },
      {
        "text": "se set either DATABASE_URL or DB_HOST/DB_USER/DB_PASSWORD in your .env file');\n      process.exit(1);\n    }\n    \n    console.log('‚úÖ Database configuration found');\n    \n    // Test connection\n    console.log('üîÑ Attempting to connect to database...');\n    const connected = await testConnection();\n    \n    if (!connected) {\n      console.log('‚ùå Failed to connect to database');\n      console.log('",
        "startLine": 16,
        "endLine": 28
      },
      {
        "text": "if (!connected) {\n      console.log('‚ùå Failed to connect to database');\n      console.log('   Check your connection string and credentials');\n      process.exit(1);\n    }\n    \n    console.log('‚úÖ Database connection successful!\\n');\n    \n    // Test database operations\n    console.log('üîÑ Testing database operations...');\n    \n    // Test a simple query\n    const result = await pool.query('S",
        "startLine": 25,
        "endLine": 38
      },
      {
        "text": "ing database operations...');\n    \n    // Test a simple query\n    const result = await pool.query('SELECT NOW() as current_time, version() as pg_version');\n    console.log('‚úÖ Query test successful');\n    console.log('   Current time:', result.rows[0].current_time);\n    console.log('   PostgreSQL version:', result.rows[0].pg_version.split(',')[0]);\n    \n    // Check if tables exist\n    console.log(",
        "startLine": 35,
        "endLine": 44
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/server.js",
    "symbols": [
      "<unknown>",
      "allowedHeaders",
      "analyticsRoutes",
      "API_VERSION",
      "app",
      "app.get('/health') callback",
      "data",
      "environment",
      "status",
      "timestamp",
      "uptime",
      "success",
      "app.get(`${API_VERSION}`) callback",
      "documentation",
      "endpoints",
      "applicant",
      "auth",
      "chat",
      "companies",
      "dashboard",
      "docs",
      "files",
      "health",
      "message",
      "version",
      "app.listen() callback",
      "port",
      "app.use('*') callback",
      "error",
      "method",
      "path",
      "app.use() callback",
      "ip",
      "url",
      "userAgent",
      "applicantRoutes",
      "authRoutes",
      "chatRoutes",
      "companyRoutes",
      "contentSecurityPolicy",
      "directives",
      "defaultSrc",
      "imgSrc",
      "scriptSrc",
      "styleSrc",
      "cors",
      "credentials",
      "dashboardRoutes",
      "dotenv",
      "errorHandler",
      "express",
      "extended",
      "fileRoutes",
      "helmet",
      "info",
      "description",
      "title",
      "limit",
      "logger",
      "methods",
      "openapi",
      "origin",
      "paths",
      "PORT",
      "process.on('SIGINT') callback",
      "process.on('SIGTERM') callback",
      "process.on('uncaughtException') callback",
      "stack",
      "process.on('unhandledRejection') callback",
      "promise",
      "reason",
      "swaggerDocument",
      "swaggerUi",
      "YAML"
    ],
    "snippet": "const express = require(\"express\");\nconst cors = require(\"cors\");\nconst dotenv = require(\"dotenv\");\nconst helmet = require(\"helmet\");\n// const rateLimit = require(\"express-rate-limit\");\n\nconst authRoutes = require(\"./routes/authRoutes\");\nconst dashboardRoutes = require(\"./routes/dashboardRoutes\");\nconst applicantRoutes = require(\"./routes/applicantRoutes\");\nconst chatRoutes = require(\"./routes/cha",
    "snippetStartLine": 1,
    "snippetEndLine": 10,
    "chunks": [
      {
        "text": "const express = require(\"express\");\nconst cors = require(\"cors\");\nconst dotenv = require(\"dotenv\");\nconst helmet = require(\"helmet\");\n// const rateLimit = require(\"express-rate-limit\");\n\nconst authRoutes = require(\"./routes/authRoutes\");\nconst dashboardRoutes = require(\"./routes/dashboardRoutes\");\nconst applicantRoutes = require(\"./routes/applicantRoutes\");\nconst chatRoutes = require(\"./routes/cha",
        "startLine": 1,
        "endLine": 10
      },
      {
        "text": "onst applicantRoutes = require(\"./routes/applicantRoutes\");\nconst chatRoutes = require(\"./routes/chatRoutes\");\nconst fileRoutes = require(\"./routes/fileRoutes\");\nconst analyticsRoutes = require(\"./routes/analyticsRoutes\");\nconst companyRoutes = require(\"./routes/companyRoutes\");\nconst { errorHandler } = require(\"./middleware/errorHandler\");\nconst logger = require(\"./utils/logger\");\nconst swaggerUi",
        "startLine": 9,
        "endLine": 16
      },
      {
        "text": "} = require(\"./middleware/errorHandler\");\nconst logger = require(\"./utils/logger\");\nconst swaggerUi = require('swagger-ui-express');\nconst YAML = require('yamljs');\n\nlet swaggerDocument;\ntry {\n  swaggerDocument = YAML.load('./docs/swagger.yaml');\n} catch (error) {\n  console.error('Error loading Swagger documentation:', error.message);\n  swaggerDocument = {\n    openapi: '3.0.3',\n    info: {",
        "startLine": 14,
        "endLine": 27
      },
      {
        "text": "gger documentation:', error.message);\n  swaggerDocument = {\n    openapi: '3.0.3',\n    info: {\n      title: 'AI Recruiter Backend API',\n      version: '1.0.0',\n      description: 'API documentation'\n    },\n    paths: {}\n  };\n}\n\n// Load environment variables\ndotenv.config();\n\nconst app = express();\n\n// Security middleware\napp.use(helmet({\n  contentSecurityPolicy: {\n    directives: {\n      defaultSrc",
        "startLine": 23,
        "endLine": 44
      },
      {
        "text": "/ Security middleware\napp.use(helmet({\n  contentSecurityPolicy: {\n    directives: {\n      defaultSrc: [\"'self'\"],\n      styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n      scriptSrc: [\"'self'\"],\n      imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    },\n  },\n}));\n\n// CORS configuration\napp.use(cors({\n  origin: process.env.FRONTEND_URL || 'https://jobsilo.hazeem.dev' || 'http://localhost:8081',\n  credentials:",
        "startLine": 40,
        "endLine": 55
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/tests/controllers/authController.test.js",
    "symbols": [],
    "snippet": "const authController = require('../../controllers/authController');\n\n// Mock the entire supabaseClient module\njest.mock('../../utils/supabaseClient', () => ({\n  auth: {\n    signUp: jest.fn(),\n    signIn: jest.fn(),\n    signOut: jest.fn(),\n    getCurrentUser: jest.fn()\n  },\n  db: {\n    createUser: jest.fn(),\n    getUserById: jest.fn(),\n    updateUser: jest.fn(),\n    createCompany: jest.fn(),\n    ge",
    "snippetStartLine": 1,
    "snippetEndLine": 16,
    "chunks": [
      {
        "text": "const authController = require('../../controllers/authController');\n\n// Mock the entire supabaseClient module\njest.mock('../../utils/supabaseClient', () => ({\n  auth: {\n    signUp: jest.fn(),\n    signIn: jest.fn(),\n    signOut: jest.fn(),\n    getCurrentUser: jest.fn()\n  },\n  db: {\n    createUser: jest.fn(),\n    getUserById: jest.fn(),\n    updateUser: jest.fn(),\n    createCompany: jest.fn(),\n    ge",
        "startLine": 1,
        "endLine": 16
      },
      {
        "text": "st.fn(),\n    getUserById: jest.fn(),\n    updateUser: jest.fn(),\n    createCompany: jest.fn(),\n    getCompanies: jest.fn()\n  }\n}));\n\ndescribe('Auth Controller', () => {\n  let req, res, next;\n  const { auth, db } = require('../../utils/supabaseClient');\n\n  beforeEach(() => {\n    req = testUtils.createMockRequest();\n    res = testUtils.createMockResponse();\n    next = testUtils.createMockNext();\n  })",
        "startLine": 12,
        "endLine": 28
      },
      {
        "text": "MockRequest();\n    res = testUtils.createMockResponse();\n    next = testUtils.createMockNext();\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('register', () => {\n    it('should register a new user successfully', async () => {\n      const userData = {\n        email: 'test@example.com',\n        password: 'password123',\n        firstName: 'John',\n        lastName: 'Doe'",
        "startLine": 25,
        "endLine": 41
      },
      {
        "text": "mple.com',\n        password: 'password123',\n        firstName: 'John',\n        lastName: 'Doe'\n      };\n\n      req.body = userData;\n\n      // Mock successful signup\n      auth.signUp.mockResolvedValue({\n        success: true,\n        data: { user: { id: 'user123', email: userData.email } }\n      });\n\n      // Mock successful user creation\n      db.createUser.mockResolvedValue({\n        success: tr",
        "startLine": 37,
        "endLine": 53
      },
      {
        "text": "// Mock successful user creation\n      db.createUser.mockResolvedValue({\n        success: true,\n        data: { id: 'user123', email: userData.email }\n      });\n\n      // Mock user not exists\n      db.getUserById.mockResolvedValue({\n        success: true,\n        data: null\n      });\n\n      await authController.register(req, res, next);\n\n      expect(res.status).toHaveBeenCalledWith(201);",
        "startLine": 49,
        "endLine": 66
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/tests/setup.js",
    "symbols": [],
    "snippet": "// Test setup file\nrequire('dotenv').config({ path: '.env.test' });\n\n// Mock environment variables for testing\nprocess.env.NODE_ENV = 'test';\nprocess.env.PORT = '3002';\n\n// Global test utilities\nglobal.testUtils = {\n  // Helper to create mock request objects\n  createMockRequest: (body = {}, params = {}, query = {}) => ({\n    body,\n    params,\n    query,\n    headers: {},\n    get: jest.fn(),\n    ip:",
    "snippetStartLine": 1,
    "snippetEndLine": 17,
    "chunks": [
      {
        "text": "// Test setup file\nrequire('dotenv').config({ path: '.env.test' });\n\n// Mock environment variables for testing\nprocess.env.NODE_ENV = 'test';\nprocess.env.PORT = '3002';\n\n// Global test utilities\nglobal.testUtils = {\n  // Helper to create mock request objects\n  createMockRequest: (body = {}, params = {}, query = {}) => ({\n    body,\n    params,\n    query,\n    headers: {},\n    get: jest.fn(),\n    ip:",
        "startLine": 1,
        "endLine": 17
      },
      {
        "text": "{}, query = {}) => ({\n    body,\n    params,\n    query,\n    headers: {},\n    get: jest.fn(),\n    ip: '127.0.0.1'\n  }),\n\n  // Helper to create mock response objects\n  createMockResponse: () => {\n    const res = {};\n    res.status = jest.fn().mockReturnValue(res);\n    res.json = jest.fn().mockReturnValue(res);\n    res.send = jest.fn().mockReturnValue(res);\n    return res;\n  },\n\n  // Helper to create",
        "startLine": 11,
        "endLine": 29
      },
      {
        "text": "lue(res);\n    res.send = jest.fn().mockReturnValue(res);\n    return res;\n  },\n\n  // Helper to create mock next function\n  createMockNext: () => jest.fn()\n};",
        "startLine": 24,
        "endLine": 31
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/aiProvider.js",
    "symbols": [],
    "snippet": "const OpenAIProvider = require('./openaiProvider');\n\nclass AIProvider {\n  constructor() {\n    this.openaiProvider = new OpenAIProvider();\n  }\n\n  async generateContent(prompt, options = {}) {\n    return await this.openaiProvider.generateContent(prompt, options);\n  }\n\n  async generateResume(resumeContent, jobDescription, preferences = {}) {\n    return await this.openaiProvider.generateResume(resumeC",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "const OpenAIProvider = require('./openaiProvider');\n\nclass AIProvider {\n  constructor() {\n    this.openaiProvider = new OpenAIProvider();\n  }\n\n  async generateContent(prompt, options = {}) {\n    return await this.openaiProvider.generateContent(prompt, options);\n  }\n\n  async generateResume(resumeContent, jobDescription, preferences = {}) {\n    return await this.openaiProvider.generateResume(resumeC",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "ent, jobDescription, preferences = {}) {\n    return await this.openaiProvider.generateResume(resumeContent, jobDescription, preferences);\n  }\n\n  async generateCoverLetter(resumeContent, jobDescription, preferences = {}) {\n    return await this.openaiProvider.generateCoverLetter(resumeContent, jobDescription, preferences);\n  }\n\n  async analyzeJob(jobDescription) {\n    return await this.openaiProvid",
        "startLine": 12,
        "endLine": 21
      },
      {
        "text": "cription, preferences);\n  }\n\n  async analyzeJob(jobDescription) {\n    return await this.openaiProvider.analyzeJob(jobDescription);\n  }\n\n  async parseResume(resumeText) {\n    return await this.openaiProvider.parseResume(resumeText);\n  }\n\n  async chat(message, context = 'general') {\n    return await this.openaiProvider.chat(message, context);\n  }\n\n  async healthCheck() {\n    return await this.openai",
        "startLine": 17,
        "endLine": 33
      },
      {
        "text": "his.openaiProvider.chat(message, context);\n  }\n\n  async healthCheck() {\n    return await this.openaiProvider.healthCheck();\n  }\n\n  // Get current provider\n  getProvider() {\n    return 'openai';\n  }\n}\n\nmodule.exports = new AIProvider();",
        "startLine": 29,
        "endLine": 42
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/databaseClient.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst { Pool } = require('pg');\nconst logger = require('./logger');\nconst { v4: uuidv4 } = require('uuid');\n\n// Database configuration\nconst getDatabaseConfig = () => {\n  // Support both DATABASE_URL and individual connection parameters\n  if (process.env.DATABASE_URL) {\n    // Parse DATABASE_URL to extract connection parameters\n    // This gives us more control over SSL",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst { Pool } = require('pg');\nconst logger = require('./logger');\nconst { v4: uuidv4 } = require('uuid');\n\n// Database configuration\nconst getDatabaseConfig = () => {\n  // Support both DATABASE_URL and individual connection parameters\n  if (process.env.DATABASE_URL) {\n    // Parse DATABASE_URL to extract connection parameters\n    // This gives us more control over SSL",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "// Parse DATABASE_URL to extract connection parameters\n    // This gives us more control over SSL configuration\n    try {\n      const url = new URL(process.env.DATABASE_URL);\n      const sslMode = url.searchParams.get('sslmode') || 'require';\n      \n      // Build connection config from parsed URL\n      const config = {\n        host: url.hostname,\n        port: parseInt(url.port) || 5432,",
        "startLine": 10,
        "endLine": 20
      },
      {
        "text": "L\n      const config = {\n        host: url.hostname,\n        port: parseInt(url.port) || 5432,\n        database: url.pathname.slice(1), // Remove leading '/'\n        user: url.username,\n        password: url.password,\n        // Always set SSL for DigitalOcean (they require it)\n        ssl: {\n          rejectUnauthorized: false // Required for DigitalOcean's self-signed certificates\n        },",
        "startLine": 16,
        "endLine": 27
      },
      {
        "text": "rejectUnauthorized: false // Required for DigitalOcean's self-signed certificates\n        },\n        max: 20, // Maximum number of clients in the pool\n        idleTimeoutMillis: 30000,\n        connectionTimeoutMillis: 2000,\n      };\n      \n      logger.info('Database config parsed from DATABASE_URL', {\n        host: config.host,\n        port: config.port,\n        database: config.database,",
        "startLine": 25,
        "endLine": 36
      },
      {
        "text": "URL', {\n        host: config.host,\n        port: config.port,\n        database: config.database,\n        sslEnabled: true\n      });\n      \n      return config;\n    } catch (error) {\n      logger.error('Error parsing DATABASE_URL, falling back to connectionString', { error: error.message });\n      // Fallback to connectionString if parsing fails\n      return {\n        connectionString: process.env.",
        "startLine": 32,
        "endLine": 44
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/dbClient.js",
    "symbols": [],
    "snippet": "/**\n * Unified database and storage client\n * This file exports both database and storage clients for backward compatibility\n * with the existing codebase that uses supabaseClient.js\n */\n\nconst { db, TABLES, ROLES, pool, testConnection } = require('./databaseClient');\nconst { storage, BUCKETS } = require('./storageClient');\n\n// Export everything for backward compatibility\nmodule.exports = {\n  db,",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "/**\n * Unified database and storage client\n * This file exports both database and storage clients for backward compatibility\n * with the existing codebase that uses supabaseClient.js\n */\n\nconst { db, TABLES, ROLES, pool, testConnection } = require('./databaseClient');\nconst { storage, BUCKETS } = require('./storageClient');\n\n// Export everything for backward compatibility\nmodule.exports = {\n  db,",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "quire('./storageClient');\n\n// Export everything for backward compatibility\nmodule.exports = {\n  db,\n  storage,\n  TABLES,\n  BUCKETS,\n  ROLES,\n  pool,\n  testConnection\n};",
        "startLine": 8,
        "endLine": 21
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/logger.js",
    "symbols": [],
    "snippet": "const winston = require('winston');\nconst path = require('path');\n\n// Create logs directory if it doesn't exist\nconst fs = require('fs');\nconst logsDir = path.join(__dirname, '../logs');\nif (!fs.existsSync(logsDir)) {\n  fs.mkdirSync(logsDir, { recursive: true });\n}\n\nconst logger = winston.createLogger({\n  level: 'info',\n  format: winston.format.combine(\n    winston.format.timestamp({\n      format:",
    "snippetStartLine": 1,
    "snippetEndLine": 15,
    "chunks": [
      {
        "text": "const winston = require('winston');\nconst path = require('path');\n\n// Create logs directory if it doesn't exist\nconst fs = require('fs');\nconst logsDir = path.join(__dirname, '../logs');\nif (!fs.existsSync(logsDir)) {\n  fs.mkdirSync(logsDir, { recursive: true });\n}\n\nconst logger = winston.createLogger({\n  level: 'info',\n  format: winston.format.combine(\n    winston.format.timestamp({\n      format:",
        "startLine": 1,
        "endLine": 15
      },
      {
        "text": "er({\n  level: 'info',\n  format: winston.format.combine(\n    winston.format.timestamp({\n      format: 'YYYY-MM-DD HH:mm:ss'\n    }),\n    winston.format.errors({ stack: true }),\n    winston.format.json()\n  ),\n  defaultMeta: { service: 'ai-recruiter-backend' },\n  transports: [\n    // Write all logs with level 'error' and below to error.log\n    new winston.transports.File({ \n      filename: path.join(l",
        "startLine": 11,
        "endLine": 24
      },
      {
        "text": "level 'error' and below to error.log\n    new winston.transports.File({ \n      filename: path.join(logsDir, 'error.log'), \n      level: 'error',\n      maxsize: 5242880, // 5MB\n      maxFiles: 5\n    }),\n    // Write all logs with level 'info' and below to combined.log\n    new winston.transports.File({ \n      filename: path.join(logsDir, 'combined.log'),\n      maxsize: 5242880, // 5MB\n      maxFiles",
        "startLine": 22,
        "endLine": 33
      },
      {
        "text": "{ \n      filename: path.join(logsDir, 'combined.log'),\n      maxsize: 5242880, // 5MB\n      maxFiles: 5\n    }),\n  ],\n});\n\n// If we're not in production, log to the console as well\nif (process.env.NODE_ENV !== 'production') {\n  logger.add(new winston.transports.Console({\n    format: winston.format.combine(\n      winston.format.colorize(),\n      winston.format.simple()\n    )\n  }));\n}\n\nmodule.exports",
        "startLine": 30,
        "endLine": 48
      },
      {
        "text": "mbine(\n      winston.format.colorize(),\n      winston.format.simple()\n    )\n  }));\n}\n\nmodule.exports = logger;",
        "startLine": 41,
        "endLine": 48
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/openaiProvider.js",
    "symbols": [],
    "snippet": "const axios = require('axios');\nconst logger = require('./logger');\n\nclass OpenAIProvider {\n  constructor() {\n    this.apiKey = process.env.OPENAI_API_KEY;\n    this.model = process.env.OPENAI_MODEL || 'gpt-3.5-turbo';\n    this.baseUrl = 'https://api.openai.com/v1';\n    \n    if (!this.apiKey) {\n      logger.error('OpenAI API key not found. Please set OPENAI_API_KEY environment variable.');\n    }\n  ",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "const axios = require('axios');\nconst logger = require('./logger');\n\nclass OpenAIProvider {\n  constructor() {\n    this.apiKey = process.env.OPENAI_API_KEY;\n    this.model = process.env.OPENAI_MODEL || 'gpt-3.5-turbo';\n    this.baseUrl = 'https://api.openai.com/v1';\n    \n    if (!this.apiKey) {\n      logger.error('OpenAI API key not found. Please set OPENAI_API_KEY environment variable.');\n    }",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "logger.error('OpenAI API key not found. Please set OPENAI_API_KEY environment variable.');\n    }\n  }\n\n  async generateContent(prompt, options = {}) {\n    try {\n      const systemPrompt = options.systemPrompt || 'You are a helpful AI assistant.';\n      const temperature = options.temperature || 0.7;\n      const maxTokens = options.maxTokens || 2048;\n\n      const response = await axios.post(`${this",
        "startLine": 11,
        "endLine": 21
      },
      {
        "text": "const maxTokens = options.maxTokens || 2048;\n\n      const response = await axios.post(`${this.baseUrl}/chat/completions`, {\n        model: this.model,\n        messages: [\n          { role: 'system', content: systemPrompt },\n          { role: 'user', content: prompt }\n        ],\n        temperature: temperature,\n        max_tokens: maxTokens,\n        top_p: 0.9\n      }, {\n        headers: {",
        "startLine": 18,
        "endLine": 32
      },
      {
        "text": "ature: temperature,\n        max_tokens: maxTokens,\n        top_p: 0.9\n      }, {\n        headers: {\n          'Authorization': `Bearer ${this.apiKey}`,\n          'Content-Type': 'application/json'\n        }\n      });\n\n      if (response.data && response.data.choices && response.data.choices[0]) {\n        return {\n          success: true,\n          data: {\n            content: response.data.choices",
        "startLine": 27,
        "endLine": 41
      },
      {
        "text": "return {\n          success: true,\n          data: {\n            content: response.data.choices[0].message.content,\n            model: this.model\n          }\n        };\n      }\n\n      return {\n        success: false,\n        error: 'Invalid response format from OpenAI'\n      };\n\n    } catch (error) {\n      logger.error('OpenAI API error', { error: error.message });\n      return {\n        succ",
        "startLine": 38,
        "endLine": 55
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/pdfGenerator.js",
    "symbols": [],
    "snippet": "const PDFDocument = require('pdfkit');\nconst fs = require('fs');\nconst path = require('path');\nconst logger = require('./logger');\n\nclass PDFGenerator {\n  constructor() {\n    this.doc = null;\n  }\n\n  // Generate PDF for resume\n  async generateResumePDF(content, format = 'A4') {\n    return new Promise((resolve, reject) => {\n      try {\n        const doc = new PDFDocument({\n          size: format,\n  ",
    "snippetStartLine": 1,
    "snippetEndLine": 17,
    "chunks": [
      {
        "text": "const PDFDocument = require('pdfkit');\nconst fs = require('fs');\nconst path = require('path');\nconst logger = require('./logger');\n\nclass PDFGenerator {\n  constructor() {\n    this.doc = null;\n  }\n\n  // Generate PDF for resume\n  async generateResumePDF(content, format = 'A4') {\n    return new Promise((resolve, reject) => {\n      try {\n        const doc = new PDFDocument({\n          size: format,",
        "startLine": 1,
        "endLine": 17
      },
      {
        "text": "((resolve, reject) => {\n      try {\n        const doc = new PDFDocument({\n          size: format,\n          margins: {\n            top: 50,\n            bottom: 50,\n            left: 50,\n            right: 50\n          }\n        });\n\n        const filename = `resume_${Date.now()}.pdf`;\n        const filepath = path.join(__dirname, '../temp', filename);\n        \n        // Ensure temp directory exis",
        "startLine": 13,
        "endLine": 28
      },
      {
        "text": "filepath = path.join(__dirname, '../temp', filename);\n        \n        // Ensure temp directory exists\n        const tempDir = path.join(__dirname, '../temp');\n        if (!fs.existsSync(tempDir)) {\n          fs.mkdirSync(tempDir, { recursive: true });\n        }\n\n        const stream = fs.createWriteStream(filepath);\n        doc.pipe(stream);\n\n        // Add header\n        doc.fontSize(24)",
        "startLine": 26,
        "endLine": 39
      },
      {
        "text": "eStream(filepath);\n        doc.pipe(stream);\n\n        // Add header\n        doc.fontSize(24)\n           .font('Helvetica-Bold')\n           .text('Professional Resume', { align: 'center' })\n           .moveDown(0.5);\n\n        // Add content\n        doc.fontSize(12)\n           .font('Helvetica')\n           .text(content, {\n             align: 'left',\n             lineGap: 2\n           });\n\n        d",
        "startLine": 34,
        "endLine": 51
      },
      {
        "text": ".text(content, {\n             align: 'left',\n             lineGap: 2\n           });\n\n        doc.end();\n\n        stream.on('finish', () => {\n          logger.info('Resume PDF generated successfully', { filename });\n          resolve({ filepath, filename });\n        });\n\n        stream.on('error', (error) => {\n          logger.error('Error generating resume PDF', { error: error.message });",
        "startLine": 46,
        "endLine": 60
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/perplexityProvider.js",
    "symbols": [],
    "snippet": "const axios = require('axios');\nconst logger = require('./logger');\n\nclass PerplexityProvider {\n  constructor() {\n    this.apiKey = process.env.OPENAI_API_KEY;\n    this.model = process.env.PERPLEXITY_MODEL || 'llama-3.1-8b-online';\n    this.baseUrl = 'https://api.perplexity.ai/chat/completions';\n    \n    if (!this.apiKey) {\n      logger.error('Perplexity API key not found. Please set OPENAI_API_KE",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const axios = require('axios');\nconst logger = require('./logger');\n\nclass PerplexityProvider {\n  constructor() {\n    this.apiKey = process.env.OPENAI_API_KEY;\n    this.model = process.env.PERPLEXITY_MODEL || 'llama-3.1-8b-online';\n    this.baseUrl = 'https://api.perplexity.ai/chat/completions';\n    \n    if (!this.apiKey) {\n      logger.error('Perplexity API key not found. Please set OPENAI_API_KE",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "if (!this.apiKey) {\n      logger.error('Perplexity API key not found. Please set OPENAI_API_KEY environment variable.');\n    }\n  }\n\n  async generateContent(prompt, options = {}) {\n    try {\n      const systemPrompt = options.systemPrompt || 'You are a helpful AI assistant.';\n      const temperature = options.temperature || 0.7;\n      const maxTokens = options.maxTokens || 2048;\n\n      const",
        "startLine": 9,
        "endLine": 21
      },
      {
        "text": "ature = options.temperature || 0.7;\n      const maxTokens = options.maxTokens || 2048;\n\n      const response = await axios.post(this.baseUrl, {\n        model: this.model,\n        messages: [\n          { role: 'system', content: systemPrompt },\n          { role: 'user', content: prompt }\n        ],\n        temperature: temperature,\n        max_tokens: maxTokens,\n        top_p: 0.9\n      }, {",
        "startLine": 18,
        "endLine": 31
      },
      {
        "text": "temperature: temperature,\n        max_tokens: maxTokens,\n        top_p: 0.9\n      }, {\n        headers: {\n          'Authorization': `Bearer ${this.apiKey}`,\n          'Content-Type': 'application/json'\n        }\n      });\n\n      if (response.data && response.data.choices && response.data.choices[0]) {\n        return {\n          success: true,\n          data: {\n            content: response",
        "startLine": 27,
        "endLine": 41
      },
      {
        "text": "ices[0]) {\n        return {\n          success: true,\n          data: {\n            content: response.data.choices[0].message.content,\n            model: this.model\n          }\n        };\n      }\n\n      return {\n        success: false,\n        error: 'Invalid response format from Perplexity'\n      };\n\n    } catch (error) {\n      logger.error('Perplexity API error', { error: error.message });",
        "startLine": 37,
        "endLine": 54
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/scrapeJobWithPlaywright.js",
    "symbols": [],
    "snippet": " ",
    "snippetStartLine": 1,
    "snippetEndLine": 1,
    "chunks": [
      {
        "text": " ",
        "startLine": 1,
        "endLine": 1
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/storageClient.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst AWS = require('aws-sdk');\nconst logger = require('./logger');\n\n// DigitalOcean Spaces configuration (S3-compatible)\nconst spacesEndpoint = process.env.SPACES_ENDPOINT || 'https://lon1.digitaloceanspaces.com';\nconst spacesKey = process.env.SPACES_KEY;\nconst spacesSecret = process.env.SPACES_SECRET;\nconst spacesRegion = process.env.SPACES_REGION || 'lon1';\nconst def",
    "snippetStartLine": 1,
    "snippetEndLine": 10,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst AWS = require('aws-sdk');\nconst logger = require('./logger');\n\n// DigitalOcean Spaces configuration (S3-compatible)\nconst spacesEndpoint = process.env.SPACES_ENDPOINT || 'https://lon1.digitaloceanspaces.com';\nconst spacesKey = process.env.SPACES_KEY;\nconst spacesSecret = process.env.SPACES_SECRET;\nconst spacesRegion = process.env.SPACES_REGION || 'lon1';\nconst def",
        "startLine": 1,
        "endLine": 10
      },
      {
        "text": "ret = process.env.SPACES_SECRET;\nconst spacesRegion = process.env.SPACES_REGION || 'lon1';\nconst defaultBucket = process.env.SPACES_BUCKET;\n\nif (!spacesKey || !spacesSecret) {\n  logger.warn('Spaces credentials not configured. File storage will not work.', {\n    hasKey: !!spacesKey,\n    hasSecret: !!spacesSecret\n  });\n}\n\n// Configure AWS SDK for DigitalOcean Spaces\nconst s3 = new AWS.S3({\n  endpoin",
        "startLine": 8,
        "endLine": 21
      },
      {
        "text": "spacesSecret\n  });\n}\n\n// Configure AWS SDK for DigitalOcean Spaces\nconst s3 = new AWS.S3({\n  endpoint: spacesEndpoint,\n  accessKeyId: spacesKey,\n  secretAccessKey: spacesSecret,\n  region: spacesRegion,\n  s3ForcePathStyle: false, // Use virtual-hosted style URLs\n  signatureVersion: 'v4'\n});\n\n// Storage bucket names\nconst BUCKETS = {\n  RESUMES: 'resumes',\n  FILES: 'files',\n  AVATARS: 'avatars'\n};\n\n/",
        "startLine": 15,
        "endLine": 36
      },
      {
        "text": "ge bucket names\nconst BUCKETS = {\n  RESUMES: 'resumes',\n  FILES: 'files',\n  AVATARS: 'avatars'\n};\n\n// Storage operations\nconst storage = {\n  /**\n   * Upload a file to DigitalOcean Spaces\n   * @param {string} bucketName - Name of the bucket\n   * @param {string} filePath - Path/filename in the bucket\n   * @param {Buffer} fileBuffer - File content as Buffer\n   * @param {object} options - Upload optio",
        "startLine": 29,
        "endLine": 43
      },
      {
        "text": "* @param {Buffer} fileBuffer - File content as Buffer\n   * @param {object} options - Upload options (contentType, acl, etc.)\n   * @returns {Promise<{success: boolean, data?: object, error?: string}>}\n   */\n  async uploadFile(bucketName, filePath, fileBuffer, options = {}) {\n    try {\n      if (!spacesKey || !spacesSecret) {\n        throw new Error('Spaces credentials not configured');\n      }",
        "startLine": 42,
        "endLine": 52
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/supabaseClient.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst { createClient } = require(\"@supabase/supabase-js\");\nconst logger = require('./logger');\n\nconst supabaseUrl = process.env.SUPABASE_URL;\nconst supabaseAnonKey = process.env.SUPABASE_ANON_KEY;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  logger.error('Missing Supabase configuration', {\n    hasUrl: !!sup",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst { createClient } = require(\"@supabase/supabase-js\");\nconst logger = require('./logger');\n\nconst supabaseUrl = process.env.SUPABASE_URL;\nconst supabaseAnonKey = process.env.SUPABASE_ANON_KEY;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  logger.error('Missing Supabase configuration', {\n    hasUrl: !!sup",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "abaseUrl || !supabaseAnonKey) {\n  logger.error('Missing Supabase configuration', {\n    hasUrl: !!supabaseUrl,\n    hasAnonKey: !!supabaseAnonKey\n  });\n  process.exit(1);\n}\n\n// Create Supabase client\nconst supabase = createClient(supabaseUrl, supabaseAnonKey);\n\n// Create admin client for server-side operations\nconst supabaseAdmin = supabaseServiceKey \n  ? createClient(supabaseUrl, supabaseServiceKey",
        "startLine": 9,
        "endLine": 22
      },
      {
        "text": "perations\nconst supabaseAdmin = supabaseServiceKey \n  ? createClient(supabaseUrl, supabaseServiceKey)\n  : null;\n\n// Database table names\nconst TABLES = {\n  USERS: 'users',\n  COMPANIES: 'companies',\n  JOBS: 'jobs',\n  CANDIDATES: 'candidates',\n  RESUMES: 'resumes',\n  INTERVIEWS: 'interviews',\n  CHAT_HISTORY: 'chat_history',\n  FILES: 'files',\n  PRO_SIGNUPS: 'pro_signups'\n};\n\n// Storage bucket names\nc",
        "startLine": 20,
        "endLine": 39
      },
      {
        "text": "ISTORY: 'chat_history',\n  FILES: 'files',\n  PRO_SIGNUPS: 'pro_signups'\n};\n\n// Storage bucket names\nconst BUCKETS = {\n  RESUMES: 'resumes',\n  FILES: 'files',\n  AVATARS: 'avatars'\n};\n\n// User roles\nconst ROLES = {\n  RECRUITER: 'recruiter',\n  APPLICANT: 'applicant',\n  ADMIN: 'admin'\n};\n\n// Database operations\nconst db = {\n  // User operations\n  async createUser(userData) {\n    try {\n      // Use the",
        "startLine": 33,
        "endLine": 57
      },
      {
        "text": "rations\nconst db = {\n  // User operations\n  async createUser(userData) {\n    try {\n      // Use the admin client to bypass RLS for user creation\n      const { data, error } = await supabaseAdmin\n        .from(TABLES.USERS)\n        .insert([userData])\n        .select()\n        .single();\n      \n      if (error) throw error;\n      return { success: true, data };\n    } catch (error) {\n      logger.er",
        "startLine": 52,
        "endLine": 67
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/package.json",
    "symbols": [
      "name",
      "version",
      "main",
      "scripts",
      "test",
      "test:watch",
      "test:coverage",
      "test:db",
      "dev",
      "start",
      "migrate",
      "migrate:reset",
      "keywords",
      "0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "author",
      "license",
      "description",
      "dependencies",
      "aws-sdk",
      "axios",
      "bcryptjs",
      "cheerio",
      "cors",
      "dotenv",
      "express",
      "express-rate-limit",
      "express-validator",
      "helmet",
      "jsonwebtoken",
      "mammoth",
      "multer",
      "node-cron",
      "pdf-parse",
      "pdf.js-extract",
      "pdf2pic",
      "pdfkit",
      "pg",
      "playwright",
      "swagger-ui-express",
      "uuid",
      "winston",
      "yamljs",
      "devDependencies",
      "jest",
      "nodemon",
      "supertest"
    ],
    "snippet": "{\n  \"name\": \"ai-recruiter-backend\",\n  \"version\": \"1.0.0\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"jest\",\n    \"test:watch\": \"jest --watch\",\n    \"test:coverage\": \"jest --coverage\",\n    \"test:db\": \"node scripts/test-db-connection.js\",\n    \"dev\": \"nodemon server.js\",\n    \"start\": \"node server.js\",\n    \"migrate\": \"node scripts/migrate.js\",\n    \"migrate:reset\": \"node scripts/migrate.js --reset\"\n  },\n  \"keywords\": [\n    \"ai\",\n    \"recruiter\",\n    \"resume\",\n    \"cover-letter\",\n    \"job-applicant\",\n    \"recruitment\"\n  ],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"description\": \"AI-powered recruitment platform with two-sided marketplace (Recruiters & Job Applicants)\",\n  \"dependencies\": {\n    \"aws-sdk\": \"^2.1691.0\",\n    \"axios\": \"^1.6.0\",\n    \"bcryptjs\": \"^2.4.3\",\n    \"cheerio\": \"^1.1.0\",\n    \"",
    "snippetStartLine": 1,
    "snippetEndLine": 31,
    "chunks": [
      {
        "text": "{\n  \"name\": \"ai-recruiter-backend\",\n  \"version\": \"1.0.0\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"jest\",\n    \"test:watch\": \"jest --watch\",\n    \"test:coverage\": \"jest --coverage\",\n    \"test:db\": \"node scripts/test-db-connection.js\",\n    \"dev\": \"nodemon server.js\",\n    \"start\": \"node server.js\",\n    \"migrate\": \"node scripts/migrate.js\",\n    \"migrate:reset\": \"node scripts/migrate.js --reset\"\n  },\n  \"keywords\": [\n    \"ai\",\n    \"recruiter\",\n    \"resume\",\n    \"cover-letter\",\n    \"job-applicant\",\n    \"recruitment\"\n  ],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"description\": \"AI-powered recruit",
        "startLine": 1,
        "endLine": 25
      },
      {
        "text": "nt\",\n    \"recruitment\"\n  ],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"description\": \"AI-powered recruitment platform with two-sided marketplace (Recruiters & Job Applicants)\",\n  \"dependencies\": {\n    \"aws-sdk\": \"^2.1691.0\",\n    \"axios\": \"^1.6.0\",\n    \"bcryptjs\": \"^2.4.3\",\n    \"cheerio\": \"^1.1.0\",\n    \"cors\": \"^2.8.5\",\n    \"dotenv\": \"^17.0.1\",\n    \"express\": \"^4.18.2\",\n    \"express-rate-limit\": \"^7.4.1\",\n    \"express-validator\": \"^7.0.1\",\n    \"helmet\": \"^8.0.0\",\n    \"jsonwebtoken\": \"^9.0.2\",\n    \"mammoth\": \"^1.9.1\",\n    \"multer\": \"^1.4.5-lts.1\",\n    \"node-cron\": \"^3.0.3\",\n    \"pdf-parse\": \"^1.1.1\"",
        "startLine": 20,
        "endLine": 41
      },
      {
        "text": "mmoth\": \"^1.9.1\",\n    \"multer\": \"^1.4.5-lts.1\",\n    \"node-cron\": \"^3.0.3\",\n    \"pdf-parse\": \"^1.1.1\",\n    \"pdf.js-extract\": \"^0.2.1\",\n    \"pdf2pic\": \"^3.2.0\",\n    \"pdfkit\": \"^0.15.0\",\n    \"pg\": \"^8.12.0\",\n    \"playwright\": \"^1.53.2\",\n    \"swagger-ui-express\": \"^4.6.3\",\n    \"uuid\": \"^9.0.1\",\n    \"winston\": \"^3.15.0\",\n    \"yamljs\": \"^0.3.0\"\n  },\n  \"devDependencies\": {\n    \"jest\": \"^29.7.0\",\n    \"nodemon\": \"^3.1.10\",\n    \"supertest\": \"^6.3.4\"\n  }\n}",
        "startLine": 38,
        "endLine": 58
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/scripts/migrate.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst fs = require('fs');\nconst path = require('path');\nconst { pool } = require('../utils/databaseClient');\nconst logger = require('../utils/logger');\n\nclass MigrationRunner {\n  constructor() {\n    this.migrationsDir = path.join(__dirname, '../migrations');\n    this.migrations = [];\n  }\n\n  async loadMigrations() {\n    try {\n      const files = fs.readdirSync(this.migra",
    "snippetStartLine": 1,
    "snippetEndLine": 15,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst fs = require('fs');\nconst path = require('path');\nconst { pool } = require('../utils/databaseClient');\nconst logger = require('../utils/logger');\n\nclass MigrationRunner {\n  constructor() {\n    this.migrationsDir = path.join(__dirname, '../migrations');\n    this.migrations = [];\n  }\n\n  async loadMigrations() {\n    try {\n      const files = fs.readdirSync(this.migra",
        "startLine": 1,
        "endLine": 15
      },
      {
        "text": "ations = [];\n  }\n\n  async loadMigrations() {\n    try {\n      const files = fs.readdirSync(this.migrationsDir)\n        .filter(file => file.endsWith('.sql'))\n        .sort();\n\n      for (const file of files) {\n        const migrationPath = path.join(this.migrationsDir, file);\n        const sql = fs.readFileSync(migrationPath, 'utf8');\n        \n        this.migrations.push({\n          name: file,",
        "startLine": 10,
        "endLine": 25
      },
      {
        "text": "eadFileSync(migrationPath, 'utf8');\n        \n        this.migrations.push({\n          name: file,\n          sql: sql\n        });\n      }\n\n      logger.info(`Loaded ${this.migrations.length} migrations`);\n      return this.migrations;\n    } catch (error) {\n      logger.error('Error loading migrations:', error);\n      throw error;\n    }\n  }\n\n  async createMigrationsTable() {\n    const client = await",
        "startLine": 21,
        "endLine": 38
      },
      {
        "text": ":', error);\n      throw error;\n    }\n  }\n\n  async createMigrationsTable() {\n    const client = await pool.connect();\n    try {\n      // Create migrations table if it doesn't exist\n      await client.query(`\n        CREATE TABLE IF NOT EXISTS migrations (\n          id SERIAL PRIMARY KEY,\n          name VARCHAR(255) UNIQUE NOT NULL,\n          executed_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()",
        "startLine": 32,
        "endLine": 46
      },
      {
        "text": "me VARCHAR(255) UNIQUE NOT NULL,\n          executed_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        )\n      `);\n      logger.info('Migrations table ready');\n    } catch (error) {\n      logger.error('Error creating migrations table:', error);\n      throw error;\n    } finally {\n      client.release();\n    }\n  }\n\n  async getExecutedMigrations() {\n    const client = await pool.connect();\n    try {",
        "startLine": 44,
        "endLine": 60
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/scripts/sync-users.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst { supabaseAdmin } = require('../utils/supabaseClient');\nconst logger = require('../utils/logger');\n\nasync function syncExistingUsers() {\n  try {\n    console.log('üîÑ Starting user sync process...');\n\n    // Get all auth users\n    const { data: authUsers, error: authError } = await supabaseAdmin.auth.admin.listUsers();\n    \n    if (authError) {\n      throw new Error",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst { supabaseAdmin } = require('../utils/supabaseClient');\nconst logger = require('../utils/logger');\n\nasync function syncExistingUsers() {\n  try {\n    console.log('üîÑ Starting user sync process...');\n\n    // Get all auth users\n    const { data: authUsers, error: authError } = await supabaseAdmin.auth.admin.listUsers();\n    \n    if (authError) {\n      throw new Error",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "rror } = await supabaseAdmin.auth.admin.listUsers();\n    \n    if (authError) {\n      throw new Error(`Failed to get auth users: ${authError.message}`);\n    }\n\n    console.log(`üìä Found ${authUsers.users.length} users in Supabase Auth`);\n\n    // Get existing users in the users table\n    const { data: existingUsers, error: dbError } = await supabaseAdmin\n      .from('users')\n      .select('id, email",
        "startLine": 10,
        "endLine": 21
      },
      {
        "text": "existingUsers, error: dbError } = await supabaseAdmin\n      .from('users')\n      .select('id, email');\n\n    if (dbError) {\n      throw new Error(`Failed to get existing users: ${dbError.message}`);\n    }\n\n    console.log(`üìä Found ${existingUsers.length} users in users table`);\n\n    const existingUserIds = new Set(existingUsers.map(u => u.id));\n    const usersToCreate = [];\n\n    // Find users tha",
        "startLine": 19,
        "endLine": 32
      },
      {
        "text": "serIds = new Set(existingUsers.map(u => u.id));\n    const usersToCreate = [];\n\n    // Find users that exist in auth but not in users table\n    for (const authUser of authUsers.users) {\n      if (!existingUserIds.has(authUser.id)) {\n        usersToCreate.push({\n          id: authUser.id,\n          email: authUser.email,\n          first_name: authUser.user_metadata?.first_name || '',\n          last_",
        "startLine": 29,
        "endLine": 39
      },
      {
        "text": "ail: authUser.email,\n          first_name: authUser.user_metadata?.first_name || '',\n          last_name: authUser.user_metadata?.last_name || '',\n          role: authUser.user_metadata?.role || 'applicant',\n          created_at: authUser.created_at,\n          updated_at: authUser.updated_at\n        });\n      }\n    }\n\n    console.log(`üÜï Found ${usersToCreate.length} users to sync`);\n\n    if (user",
        "startLine": 37,
        "endLine": 49
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/scripts/test-db-connection.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst { testConnection, db, pool } = require('../utils/databaseClient');\nconst logger = require('../utils/logger');\n\nasync function testDatabaseConnection() {\n  console.log('üîç Testing database connection...\\n');\n  \n  try {\n    // Test environment variables\n    const requiredEnvVars = ['DATABASE_URL'];\n    const hasDbUrl = !!process.env.DATABASE_URL;\n    const hasDbPara",
    "snippetStartLine": 1,
    "snippetEndLine": 12,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst { testConnection, db, pool } = require('../utils/databaseClient');\nconst logger = require('../utils/logger');\n\nasync function testDatabaseConnection() {\n  console.log('üîç Testing database connection...\\n');\n  \n  try {\n    // Test environment variables\n    const requiredEnvVars = ['DATABASE_URL'];\n    const hasDbUrl = !!process.env.DATABASE_URL;\n    const hasDbPara",
        "startLine": 1,
        "endLine": 12
      },
      {
        "text": "iredEnvVars = ['DATABASE_URL'];\n    const hasDbUrl = !!process.env.DATABASE_URL;\n    const hasDbParams = process.env.DB_HOST && process.env.DB_USER && process.env.DB_PASSWORD;\n    \n    if (!hasDbUrl && !hasDbParams) {\n      console.log('‚ùå Missing database configuration!');\n      console.log('   Please set either DATABASE_URL or DB_HOST/DB_USER/DB_PASSWORD in your .env file');\n      process.exit(1)",
        "startLine": 10,
        "endLine": 17
      },
      {
        "text": "se set either DATABASE_URL or DB_HOST/DB_USER/DB_PASSWORD in your .env file');\n      process.exit(1);\n    }\n    \n    console.log('‚úÖ Database configuration found');\n    \n    // Test connection\n    console.log('üîÑ Attempting to connect to database...');\n    const connected = await testConnection();\n    \n    if (!connected) {\n      console.log('‚ùå Failed to connect to database');\n      console.log('",
        "startLine": 16,
        "endLine": 28
      },
      {
        "text": "if (!connected) {\n      console.log('‚ùå Failed to connect to database');\n      console.log('   Check your connection string and credentials');\n      process.exit(1);\n    }\n    \n    console.log('‚úÖ Database connection successful!\\n');\n    \n    // Test database operations\n    console.log('üîÑ Testing database operations...');\n    \n    // Test a simple query\n    const result = await pool.query('S",
        "startLine": 25,
        "endLine": 38
      },
      {
        "text": "ing database operations...');\n    \n    // Test a simple query\n    const result = await pool.query('SELECT NOW() as current_time, version() as pg_version');\n    console.log('‚úÖ Query test successful');\n    console.log('   Current time:', result.rows[0].current_time);\n    console.log('   PostgreSQL version:', result.rows[0].pg_version.split(',')[0]);\n    \n    // Check if tables exist\n    console.log(",
        "startLine": 35,
        "endLine": 44
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/server.js",
    "symbols": [],
    "snippet": "const express = require(\"express\");\nconst cors = require(\"cors\");\nconst dotenv = require(\"dotenv\");\nconst helmet = require(\"helmet\");\n// const rateLimit = require(\"express-rate-limit\");\n\nconst authRoutes = require(\"./routes/authRoutes\");\nconst dashboardRoutes = require(\"./routes/dashboardRoutes\");\nconst applicantRoutes = require(\"./routes/applicantRoutes\");\nconst chatRoutes = require(\"./routes/cha",
    "snippetStartLine": 1,
    "snippetEndLine": 10,
    "chunks": [
      {
        "text": "const express = require(\"express\");\nconst cors = require(\"cors\");\nconst dotenv = require(\"dotenv\");\nconst helmet = require(\"helmet\");\n// const rateLimit = require(\"express-rate-limit\");\n\nconst authRoutes = require(\"./routes/authRoutes\");\nconst dashboardRoutes = require(\"./routes/dashboardRoutes\");\nconst applicantRoutes = require(\"./routes/applicantRoutes\");\nconst chatRoutes = require(\"./routes/cha",
        "startLine": 1,
        "endLine": 10
      },
      {
        "text": "onst applicantRoutes = require(\"./routes/applicantRoutes\");\nconst chatRoutes = require(\"./routes/chatRoutes\");\nconst fileRoutes = require(\"./routes/fileRoutes\");\nconst analyticsRoutes = require(\"./routes/analyticsRoutes\");\nconst companyRoutes = require(\"./routes/companyRoutes\");\nconst { errorHandler } = require(\"./middleware/errorHandler\");\nconst logger = require(\"./utils/logger\");\nconst swaggerUi",
        "startLine": 9,
        "endLine": 16
      },
      {
        "text": "} = require(\"./middleware/errorHandler\");\nconst logger = require(\"./utils/logger\");\nconst swaggerUi = require('swagger-ui-express');\nconst YAML = require('yamljs');\n\nlet swaggerDocument;\ntry {\n  swaggerDocument = YAML.load('./docs/swagger.yaml');\n} catch (error) {\n  console.error('Error loading Swagger documentation:', error.message);\n  swaggerDocument = {\n    openapi: '3.0.3',\n    info: {",
        "startLine": 14,
        "endLine": 27
      },
      {
        "text": "gger documentation:', error.message);\n  swaggerDocument = {\n    openapi: '3.0.3',\n    info: {\n      title: 'AI Recruiter Backend API',\n      version: '1.0.0',\n      description: 'API documentation'\n    },\n    paths: {}\n  };\n}\n\n// Load environment variables\ndotenv.config();\n\nconst app = express();\n\n// Security middleware\napp.use(helmet({\n  contentSecurityPolicy: {\n    directives: {\n      defaultSrc",
        "startLine": 23,
        "endLine": 44
      },
      {
        "text": "/ Security middleware\napp.use(helmet({\n  contentSecurityPolicy: {\n    directives: {\n      defaultSrc: [\"'self'\"],\n      styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n      scriptSrc: [\"'self'\"],\n      imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    },\n  },\n}));\n\n// CORS configuration\napp.use(cors({\n  origin: process.env.FRONTEND_URL || 'https://jobsilo.hazeem.dev' || 'http://localhost:8081',\n  credentials:",
        "startLine": 40,
        "endLine": 55
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/tests/controllers/authController.test.js",
    "symbols": [],
    "snippet": "const authController = require('../../controllers/authController');\n\n// Mock the entire supabaseClient module\njest.mock('../../utils/supabaseClient', () => ({\n  auth: {\n    signUp: jest.fn(),\n    signIn: jest.fn(),\n    signOut: jest.fn(),\n    getCurrentUser: jest.fn()\n  },\n  db: {\n    createUser: jest.fn(),\n    getUserById: jest.fn(),\n    updateUser: jest.fn(),\n    createCompany: jest.fn(),\n    ge",
    "snippetStartLine": 1,
    "snippetEndLine": 16,
    "chunks": [
      {
        "text": "const authController = require('../../controllers/authController');\n\n// Mock the entire supabaseClient module\njest.mock('../../utils/supabaseClient', () => ({\n  auth: {\n    signUp: jest.fn(),\n    signIn: jest.fn(),\n    signOut: jest.fn(),\n    getCurrentUser: jest.fn()\n  },\n  db: {\n    createUser: jest.fn(),\n    getUserById: jest.fn(),\n    updateUser: jest.fn(),\n    createCompany: jest.fn(),\n    ge",
        "startLine": 1,
        "endLine": 16
      },
      {
        "text": "st.fn(),\n    getUserById: jest.fn(),\n    updateUser: jest.fn(),\n    createCompany: jest.fn(),\n    getCompanies: jest.fn()\n  }\n}));\n\ndescribe('Auth Controller', () => {\n  let req, res, next;\n  const { auth, db } = require('../../utils/supabaseClient');\n\n  beforeEach(() => {\n    req = testUtils.createMockRequest();\n    res = testUtils.createMockResponse();\n    next = testUtils.createMockNext();\n  })",
        "startLine": 12,
        "endLine": 28
      },
      {
        "text": "MockRequest();\n    res = testUtils.createMockResponse();\n    next = testUtils.createMockNext();\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('register', () => {\n    it('should register a new user successfully', async () => {\n      const userData = {\n        email: 'test@example.com',\n        password: 'password123',\n        firstName: 'John',\n        lastName: 'Doe'",
        "startLine": 25,
        "endLine": 41
      },
      {
        "text": "mple.com',\n        password: 'password123',\n        firstName: 'John',\n        lastName: 'Doe'\n      };\n\n      req.body = userData;\n\n      // Mock successful signup\n      auth.signUp.mockResolvedValue({\n        success: true,\n        data: { user: { id: 'user123', email: userData.email } }\n      });\n\n      // Mock successful user creation\n      db.createUser.mockResolvedValue({\n        success: tr",
        "startLine": 37,
        "endLine": 53
      },
      {
        "text": "// Mock successful user creation\n      db.createUser.mockResolvedValue({\n        success: true,\n        data: { id: 'user123', email: userData.email }\n      });\n\n      // Mock user not exists\n      db.getUserById.mockResolvedValue({\n        success: true,\n        data: null\n      });\n\n      await authController.register(req, res, next);\n\n      expect(res.status).toHaveBeenCalledWith(201);",
        "startLine": 49,
        "endLine": 66
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/tests/setup.js",
    "symbols": [],
    "snippet": "// Test setup file\nrequire('dotenv').config({ path: '.env.test' });\n\n// Mock environment variables for testing\nprocess.env.NODE_ENV = 'test';\nprocess.env.PORT = '3002';\n\n// Global test utilities\nglobal.testUtils = {\n  // Helper to create mock request objects\n  createMockRequest: (body = {}, params = {}, query = {}) => ({\n    body,\n    params,\n    query,\n    headers: {},\n    get: jest.fn(),\n    ip:",
    "snippetStartLine": 1,
    "snippetEndLine": 17,
    "chunks": [
      {
        "text": "// Test setup file\nrequire('dotenv').config({ path: '.env.test' });\n\n// Mock environment variables for testing\nprocess.env.NODE_ENV = 'test';\nprocess.env.PORT = '3002';\n\n// Global test utilities\nglobal.testUtils = {\n  // Helper to create mock request objects\n  createMockRequest: (body = {}, params = {}, query = {}) => ({\n    body,\n    params,\n    query,\n    headers: {},\n    get: jest.fn(),\n    ip:",
        "startLine": 1,
        "endLine": 17
      },
      {
        "text": "{}, query = {}) => ({\n    body,\n    params,\n    query,\n    headers: {},\n    get: jest.fn(),\n    ip: '127.0.0.1'\n  }),\n\n  // Helper to create mock response objects\n  createMockResponse: () => {\n    const res = {};\n    res.status = jest.fn().mockReturnValue(res);\n    res.json = jest.fn().mockReturnValue(res);\n    res.send = jest.fn().mockReturnValue(res);\n    return res;\n  },\n\n  // Helper to create",
        "startLine": 11,
        "endLine": 29
      },
      {
        "text": "lue(res);\n    res.send = jest.fn().mockReturnValue(res);\n    return res;\n  },\n\n  // Helper to create mock next function\n  createMockNext: () => jest.fn()\n};",
        "startLine": 24,
        "endLine": 31
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/aiProvider.js",
    "symbols": [],
    "snippet": "const OpenAIProvider = require('./openaiProvider');\n\nclass AIProvider {\n  constructor() {\n    this.openaiProvider = new OpenAIProvider();\n  }\n\n  async generateContent(prompt, options = {}) {\n    return await this.openaiProvider.generateContent(prompt, options);\n  }\n\n  async generateResume(resumeContent, jobDescription, preferences = {}) {\n    return await this.openaiProvider.generateResume(resumeC",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "const OpenAIProvider = require('./openaiProvider');\n\nclass AIProvider {\n  constructor() {\n    this.openaiProvider = new OpenAIProvider();\n  }\n\n  async generateContent(prompt, options = {}) {\n    return await this.openaiProvider.generateContent(prompt, options);\n  }\n\n  async generateResume(resumeContent, jobDescription, preferences = {}) {\n    return await this.openaiProvider.generateResume(resumeC",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "ent, jobDescription, preferences = {}) {\n    return await this.openaiProvider.generateResume(resumeContent, jobDescription, preferences);\n  }\n\n  async generateCoverLetter(resumeContent, jobDescription, preferences = {}) {\n    return await this.openaiProvider.generateCoverLetter(resumeContent, jobDescription, preferences);\n  }\n\n  async analyzeJob(jobDescription) {\n    return await this.openaiProvid",
        "startLine": 12,
        "endLine": 21
      },
      {
        "text": "cription, preferences);\n  }\n\n  async analyzeJob(jobDescription) {\n    return await this.openaiProvider.analyzeJob(jobDescription);\n  }\n\n  async parseResume(resumeText) {\n    return await this.openaiProvider.parseResume(resumeText);\n  }\n\n  async chat(message, context = 'general') {\n    return await this.openaiProvider.chat(message, context);\n  }\n\n  async healthCheck() {\n    return await this.openai",
        "startLine": 17,
        "endLine": 33
      },
      {
        "text": "his.openaiProvider.chat(message, context);\n  }\n\n  async healthCheck() {\n    return await this.openaiProvider.healthCheck();\n  }\n\n  // Get current provider\n  getProvider() {\n    return 'openai';\n  }\n}\n\nmodule.exports = new AIProvider();",
        "startLine": 29,
        "endLine": 42
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/databaseClient.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst { Pool } = require('pg');\nconst logger = require('./logger');\nconst { v4: uuidv4 } = require('uuid');\n\n// Database configuration\nconst getDatabaseConfig = () => {\n  // Support both DATABASE_URL and individual connection parameters\n  if (process.env.DATABASE_URL) {\n    // Parse DATABASE_URL to extract connection parameters\n    // This gives us more control over SSL",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst { Pool } = require('pg');\nconst logger = require('./logger');\nconst { v4: uuidv4 } = require('uuid');\n\n// Database configuration\nconst getDatabaseConfig = () => {\n  // Support both DATABASE_URL and individual connection parameters\n  if (process.env.DATABASE_URL) {\n    // Parse DATABASE_URL to extract connection parameters\n    // This gives us more control over SSL",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "// Parse DATABASE_URL to extract connection parameters\n    // This gives us more control over SSL configuration\n    try {\n      const url = new URL(process.env.DATABASE_URL);\n      const sslMode = url.searchParams.get('sslmode') || 'require';\n      \n      // Build connection config from parsed URL\n      const config = {\n        host: url.hostname,\n        port: parseInt(url.port) || 5432,",
        "startLine": 10,
        "endLine": 20
      },
      {
        "text": "L\n      const config = {\n        host: url.hostname,\n        port: parseInt(url.port) || 5432,\n        database: url.pathname.slice(1), // Remove leading '/'\n        user: url.username,\n        password: url.password,\n        // Always set SSL for DigitalOcean (they require it)\n        ssl: {\n          rejectUnauthorized: false // Required for DigitalOcean's self-signed certificates\n        },",
        "startLine": 16,
        "endLine": 27
      },
      {
        "text": "rejectUnauthorized: false // Required for DigitalOcean's self-signed certificates\n        },\n        max: 20, // Maximum number of clients in the pool\n        idleTimeoutMillis: 30000,\n        connectionTimeoutMillis: 2000,\n      };\n      \n      logger.info('Database config parsed from DATABASE_URL', {\n        host: config.host,\n        port: config.port,\n        database: config.database,",
        "startLine": 25,
        "endLine": 36
      },
      {
        "text": "URL', {\n        host: config.host,\n        port: config.port,\n        database: config.database,\n        sslEnabled: true\n      });\n      \n      return config;\n    } catch (error) {\n      logger.error('Error parsing DATABASE_URL, falling back to connectionString', { error: error.message });\n      // Fallback to connectionString if parsing fails\n      return {\n        connectionString: process.env.",
        "startLine": 32,
        "endLine": 44
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/dbClient.js",
    "symbols": [],
    "snippet": "/**\n * Unified database and storage client\n * This file exports both database and storage clients for backward compatibility\n * with the existing codebase that uses supabaseClient.js\n */\n\nconst { db, TABLES, ROLES, pool, testConnection } = require('./databaseClient');\nconst { storage, BUCKETS } = require('./storageClient');\n\n// Export everything for backward compatibility\nmodule.exports = {\n  db,",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "/**\n * Unified database and storage client\n * This file exports both database and storage clients for backward compatibility\n * with the existing codebase that uses supabaseClient.js\n */\n\nconst { db, TABLES, ROLES, pool, testConnection } = require('./databaseClient');\nconst { storage, BUCKETS } = require('./storageClient');\n\n// Export everything for backward compatibility\nmodule.exports = {\n  db,",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "quire('./storageClient');\n\n// Export everything for backward compatibility\nmodule.exports = {\n  db,\n  storage,\n  TABLES,\n  BUCKETS,\n  ROLES,\n  pool,\n  testConnection\n};",
        "startLine": 8,
        "endLine": 21
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/logger.js",
    "symbols": [],
    "snippet": "const winston = require('winston');\nconst path = require('path');\n\n// Create logs directory if it doesn't exist\nconst fs = require('fs');\nconst logsDir = path.join(__dirname, '../logs');\nif (!fs.existsSync(logsDir)) {\n  fs.mkdirSync(logsDir, { recursive: true });\n}\n\nconst logger = winston.createLogger({\n  level: 'info',\n  format: winston.format.combine(\n    winston.format.timestamp({\n      format:",
    "snippetStartLine": 1,
    "snippetEndLine": 15,
    "chunks": [
      {
        "text": "const winston = require('winston');\nconst path = require('path');\n\n// Create logs directory if it doesn't exist\nconst fs = require('fs');\nconst logsDir = path.join(__dirname, '../logs');\nif (!fs.existsSync(logsDir)) {\n  fs.mkdirSync(logsDir, { recursive: true });\n}\n\nconst logger = winston.createLogger({\n  level: 'info',\n  format: winston.format.combine(\n    winston.format.timestamp({\n      format:",
        "startLine": 1,
        "endLine": 15
      },
      {
        "text": "er({\n  level: 'info',\n  format: winston.format.combine(\n    winston.format.timestamp({\n      format: 'YYYY-MM-DD HH:mm:ss'\n    }),\n    winston.format.errors({ stack: true }),\n    winston.format.json()\n  ),\n  defaultMeta: { service: 'ai-recruiter-backend' },\n  transports: [\n    // Write all logs with level 'error' and below to error.log\n    new winston.transports.File({ \n      filename: path.join(l",
        "startLine": 11,
        "endLine": 24
      },
      {
        "text": "level 'error' and below to error.log\n    new winston.transports.File({ \n      filename: path.join(logsDir, 'error.log'), \n      level: 'error',\n      maxsize: 5242880, // 5MB\n      maxFiles: 5\n    }),\n    // Write all logs with level 'info' and below to combined.log\n    new winston.transports.File({ \n      filename: path.join(logsDir, 'combined.log'),\n      maxsize: 5242880, // 5MB\n      maxFiles",
        "startLine": 22,
        "endLine": 33
      },
      {
        "text": "{ \n      filename: path.join(logsDir, 'combined.log'),\n      maxsize: 5242880, // 5MB\n      maxFiles: 5\n    }),\n  ],\n});\n\n// If we're not in production, log to the console as well\nif (process.env.NODE_ENV !== 'production') {\n  logger.add(new winston.transports.Console({\n    format: winston.format.combine(\n      winston.format.colorize(),\n      winston.format.simple()\n    )\n  }));\n}\n\nmodule.exports",
        "startLine": 30,
        "endLine": 48
      },
      {
        "text": "mbine(\n      winston.format.colorize(),\n      winston.format.simple()\n    )\n  }));\n}\n\nmodule.exports = logger;",
        "startLine": 41,
        "endLine": 48
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/openaiProvider.js",
    "symbols": [],
    "snippet": "const axios = require('axios');\nconst logger = require('./logger');\n\nclass OpenAIProvider {\n  constructor() {\n    this.apiKey = process.env.OPENAI_API_KEY;\n    this.model = process.env.OPENAI_MODEL || 'gpt-3.5-turbo';\n    this.baseUrl = 'https://api.openai.com/v1';\n    \n    if (!this.apiKey) {\n      logger.error('OpenAI API key not found. Please set OPENAI_API_KEY environment variable.');\n    }\n  ",
    "snippetStartLine": 1,
    "snippetEndLine": 13,
    "chunks": [
      {
        "text": "const axios = require('axios');\nconst logger = require('./logger');\n\nclass OpenAIProvider {\n  constructor() {\n    this.apiKey = process.env.OPENAI_API_KEY;\n    this.model = process.env.OPENAI_MODEL || 'gpt-3.5-turbo';\n    this.baseUrl = 'https://api.openai.com/v1';\n    \n    if (!this.apiKey) {\n      logger.error('OpenAI API key not found. Please set OPENAI_API_KEY environment variable.');\n    }",
        "startLine": 1,
        "endLine": 13
      },
      {
        "text": "logger.error('OpenAI API key not found. Please set OPENAI_API_KEY environment variable.');\n    }\n  }\n\n  async generateContent(prompt, options = {}) {\n    try {\n      const systemPrompt = options.systemPrompt || 'You are a helpful AI assistant.';\n      const temperature = options.temperature || 0.7;\n      const maxTokens = options.maxTokens || 2048;\n\n      const response = await axios.post(`${this",
        "startLine": 11,
        "endLine": 21
      },
      {
        "text": "const maxTokens = options.maxTokens || 2048;\n\n      const response = await axios.post(`${this.baseUrl}/chat/completions`, {\n        model: this.model,\n        messages: [\n          { role: 'system', content: systemPrompt },\n          { role: 'user', content: prompt }\n        ],\n        temperature: temperature,\n        max_tokens: maxTokens,\n        top_p: 0.9\n      }, {\n        headers: {",
        "startLine": 18,
        "endLine": 32
      },
      {
        "text": "ature: temperature,\n        max_tokens: maxTokens,\n        top_p: 0.9\n      }, {\n        headers: {\n          'Authorization': `Bearer ${this.apiKey}`,\n          'Content-Type': 'application/json'\n        }\n      });\n\n      if (response.data && response.data.choices && response.data.choices[0]) {\n        return {\n          success: true,\n          data: {\n            content: response.data.choices",
        "startLine": 27,
        "endLine": 41
      },
      {
        "text": "return {\n          success: true,\n          data: {\n            content: response.data.choices[0].message.content,\n            model: this.model\n          }\n        };\n      }\n\n      return {\n        success: false,\n        error: 'Invalid response format from OpenAI'\n      };\n\n    } catch (error) {\n      logger.error('OpenAI API error', { error: error.message });\n      return {\n        succ",
        "startLine": 38,
        "endLine": 55
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/pdfGenerator.js",
    "symbols": [],
    "snippet": "const PDFDocument = require('pdfkit');\nconst fs = require('fs');\nconst path = require('path');\nconst logger = require('./logger');\n\nclass PDFGenerator {\n  constructor() {\n    this.doc = null;\n  }\n\n  // Generate PDF for resume\n  async generateResumePDF(content, format = 'A4') {\n    return new Promise((resolve, reject) => {\n      try {\n        const doc = new PDFDocument({\n          size: format,\n  ",
    "snippetStartLine": 1,
    "snippetEndLine": 17,
    "chunks": [
      {
        "text": "const PDFDocument = require('pdfkit');\nconst fs = require('fs');\nconst path = require('path');\nconst logger = require('./logger');\n\nclass PDFGenerator {\n  constructor() {\n    this.doc = null;\n  }\n\n  // Generate PDF for resume\n  async generateResumePDF(content, format = 'A4') {\n    return new Promise((resolve, reject) => {\n      try {\n        const doc = new PDFDocument({\n          size: format,",
        "startLine": 1,
        "endLine": 17
      },
      {
        "text": "((resolve, reject) => {\n      try {\n        const doc = new PDFDocument({\n          size: format,\n          margins: {\n            top: 50,\n            bottom: 50,\n            left: 50,\n            right: 50\n          }\n        });\n\n        const filename = `resume_${Date.now()}.pdf`;\n        const filepath = path.join(__dirname, '../temp', filename);\n        \n        // Ensure temp directory exis",
        "startLine": 13,
        "endLine": 28
      },
      {
        "text": "filepath = path.join(__dirname, '../temp', filename);\n        \n        // Ensure temp directory exists\n        const tempDir = path.join(__dirname, '../temp');\n        if (!fs.existsSync(tempDir)) {\n          fs.mkdirSync(tempDir, { recursive: true });\n        }\n\n        const stream = fs.createWriteStream(filepath);\n        doc.pipe(stream);\n\n        // Add header\n        doc.fontSize(24)",
        "startLine": 26,
        "endLine": 39
      },
      {
        "text": "eStream(filepath);\n        doc.pipe(stream);\n\n        // Add header\n        doc.fontSize(24)\n           .font('Helvetica-Bold')\n           .text('Professional Resume', { align: 'center' })\n           .moveDown(0.5);\n\n        // Add content\n        doc.fontSize(12)\n           .font('Helvetica')\n           .text(content, {\n             align: 'left',\n             lineGap: 2\n           });\n\n        d",
        "startLine": 34,
        "endLine": 51
      },
      {
        "text": ".text(content, {\n             align: 'left',\n             lineGap: 2\n           });\n\n        doc.end();\n\n        stream.on('finish', () => {\n          logger.info('Resume PDF generated successfully', { filename });\n          resolve({ filepath, filename });\n        });\n\n        stream.on('error', (error) => {\n          logger.error('Error generating resume PDF', { error: error.message });",
        "startLine": 46,
        "endLine": 60
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/perplexityProvider.js",
    "symbols": [],
    "snippet": "const axios = require('axios');\nconst logger = require('./logger');\n\nclass PerplexityProvider {\n  constructor() {\n    this.apiKey = process.env.OPENAI_API_KEY;\n    this.model = process.env.PERPLEXITY_MODEL || 'llama-3.1-8b-online';\n    this.baseUrl = 'https://api.perplexity.ai/chat/completions';\n    \n    if (!this.apiKey) {\n      logger.error('Perplexity API key not found. Please set OPENAI_API_KE",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "const axios = require('axios');\nconst logger = require('./logger');\n\nclass PerplexityProvider {\n  constructor() {\n    this.apiKey = process.env.OPENAI_API_KEY;\n    this.model = process.env.PERPLEXITY_MODEL || 'llama-3.1-8b-online';\n    this.baseUrl = 'https://api.perplexity.ai/chat/completions';\n    \n    if (!this.apiKey) {\n      logger.error('Perplexity API key not found. Please set OPENAI_API_KE",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "if (!this.apiKey) {\n      logger.error('Perplexity API key not found. Please set OPENAI_API_KEY environment variable.');\n    }\n  }\n\n  async generateContent(prompt, options = {}) {\n    try {\n      const systemPrompt = options.systemPrompt || 'You are a helpful AI assistant.';\n      const temperature = options.temperature || 0.7;\n      const maxTokens = options.maxTokens || 2048;\n\n      const",
        "startLine": 9,
        "endLine": 21
      },
      {
        "text": "ature = options.temperature || 0.7;\n      const maxTokens = options.maxTokens || 2048;\n\n      const response = await axios.post(this.baseUrl, {\n        model: this.model,\n        messages: [\n          { role: 'system', content: systemPrompt },\n          { role: 'user', content: prompt }\n        ],\n        temperature: temperature,\n        max_tokens: maxTokens,\n        top_p: 0.9\n      }, {",
        "startLine": 18,
        "endLine": 31
      },
      {
        "text": "temperature: temperature,\n        max_tokens: maxTokens,\n        top_p: 0.9\n      }, {\n        headers: {\n          'Authorization': `Bearer ${this.apiKey}`,\n          'Content-Type': 'application/json'\n        }\n      });\n\n      if (response.data && response.data.choices && response.data.choices[0]) {\n        return {\n          success: true,\n          data: {\n            content: response",
        "startLine": 27,
        "endLine": 41
      },
      {
        "text": "ices[0]) {\n        return {\n          success: true,\n          data: {\n            content: response.data.choices[0].message.content,\n            model: this.model\n          }\n        };\n      }\n\n      return {\n        success: false,\n        error: 'Invalid response format from Perplexity'\n      };\n\n    } catch (error) {\n      logger.error('Perplexity API error', { error: error.message });",
        "startLine": 37,
        "endLine": 54
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/scrapeJobWithPlaywright.js",
    "symbols": [],
    "snippet": " ",
    "snippetStartLine": 1,
    "snippetEndLine": 1,
    "chunks": [
      {
        "text": " ",
        "startLine": 1,
        "endLine": 1
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/storageClient.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst AWS = require('aws-sdk');\nconst logger = require('./logger');\n\n// DigitalOcean Spaces configuration (S3-compatible)\nconst spacesEndpoint = process.env.SPACES_ENDPOINT || 'https://nyc3.digitaloceanspaces.com';\nconst spacesKey = process.env.SPACES_KEY;\nconst spacesSecret = process.env.SPACES_SECRET;\nconst spacesRegion = process.env.SPACES_REGION || 'nyc3';\nconst def",
    "snippetStartLine": 1,
    "snippetEndLine": 10,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst AWS = require('aws-sdk');\nconst logger = require('./logger');\n\n// DigitalOcean Spaces configuration (S3-compatible)\nconst spacesEndpoint = process.env.SPACES_ENDPOINT || 'https://nyc3.digitaloceanspaces.com';\nconst spacesKey = process.env.SPACES_KEY;\nconst spacesSecret = process.env.SPACES_SECRET;\nconst spacesRegion = process.env.SPACES_REGION || 'nyc3';\nconst def",
        "startLine": 1,
        "endLine": 10
      },
      {
        "text": "ret = process.env.SPACES_SECRET;\nconst spacesRegion = process.env.SPACES_REGION || 'nyc3';\nconst defaultBucket = process.env.SPACES_BUCKET;\n\nif (!spacesKey || !spacesSecret) {\n  logger.warn('Spaces credentials not configured. File storage will not work.', {\n    hasKey: !!spacesKey,\n    hasSecret: !!spacesSecret\n  });\n}\n\n// Configure AWS SDK for DigitalOcean Spaces\nconst s3 = new AWS.S3({\n  endpoin",
        "startLine": 8,
        "endLine": 21
      },
      {
        "text": "spacesSecret\n  });\n}\n\n// Configure AWS SDK for DigitalOcean Spaces\nconst s3 = new AWS.S3({\n  endpoint: spacesEndpoint,\n  accessKeyId: spacesKey,\n  secretAccessKey: spacesSecret,\n  region: spacesRegion,\n  s3ForcePathStyle: false, // Use virtual-hosted style URLs\n  signatureVersion: 'v4'\n});\n\n// Storage bucket names\nconst BUCKETS = {\n  RESUMES: 'resumes',\n  FILES: 'files',\n  AVATARS: 'avatars'\n};\n\n/",
        "startLine": 15,
        "endLine": 36
      },
      {
        "text": "ge bucket names\nconst BUCKETS = {\n  RESUMES: 'resumes',\n  FILES: 'files',\n  AVATARS: 'avatars'\n};\n\n// Storage operations\nconst storage = {\n  /**\n   * Upload a file to DigitalOcean Spaces\n   * @param {string} bucketName - Name of the bucket\n   * @param {string} filePath - Path/filename in the bucket\n   * @param {Buffer} fileBuffer - File content as Buffer\n   * @param {object} options - Upload optio",
        "startLine": 29,
        "endLine": 43
      },
      {
        "text": "* @param {Buffer} fileBuffer - File content as Buffer\n   * @param {object} options - Upload options (contentType, acl, etc.)\n   * @returns {Promise<{success: boolean, data?: object, error?: string}>}\n   */\n  async uploadFile(bucketName, filePath, fileBuffer, options = {}) {\n    try {\n      if (!spacesKey || !spacesSecret) {\n        throw new Error('Spaces credentials not configured');\n      }",
        "startLine": 42,
        "endLine": 52
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/utils/supabaseClient.js",
    "symbols": [],
    "snippet": "require('dotenv').config();\nconst { createClient } = require(\"@supabase/supabase-js\");\nconst logger = require('./logger');\n\nconst supabaseUrl = process.env.SUPABASE_URL;\nconst supabaseAnonKey = process.env.SUPABASE_ANON_KEY;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  logger.error('Missing Supabase configuration', {\n    hasUrl: !!sup",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "require('dotenv').config();\nconst { createClient } = require(\"@supabase/supabase-js\");\nconst logger = require('./logger');\n\nconst supabaseUrl = process.env.SUPABASE_URL;\nconst supabaseAnonKey = process.env.SUPABASE_ANON_KEY;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  logger.error('Missing Supabase configuration', {\n    hasUrl: !!sup",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "abaseUrl || !supabaseAnonKey) {\n  logger.error('Missing Supabase configuration', {\n    hasUrl: !!supabaseUrl,\n    hasAnonKey: !!supabaseAnonKey\n  });\n  process.exit(1);\n}\n\n// Create Supabase client\nconst supabase = createClient(supabaseUrl, supabaseAnonKey);\n\n// Create admin client for server-side operations\nconst supabaseAdmin = supabaseServiceKey \n  ? createClient(supabaseUrl, supabaseServiceKey",
        "startLine": 9,
        "endLine": 22
      },
      {
        "text": "perations\nconst supabaseAdmin = supabaseServiceKey \n  ? createClient(supabaseUrl, supabaseServiceKey)\n  : null;\n\n// Database table names\nconst TABLES = {\n  USERS: 'users',\n  COMPANIES: 'companies',\n  JOBS: 'jobs',\n  CANDIDATES: 'candidates',\n  RESUMES: 'resumes',\n  INTERVIEWS: 'interviews',\n  CHAT_HISTORY: 'chat_history',\n  FILES: 'files',\n  PRO_SIGNUPS: 'pro_signups'\n};\n\n// Storage bucket names\nc",
        "startLine": 20,
        "endLine": 39
      },
      {
        "text": "ISTORY: 'chat_history',\n  FILES: 'files',\n  PRO_SIGNUPS: 'pro_signups'\n};\n\n// Storage bucket names\nconst BUCKETS = {\n  RESUMES: 'resumes',\n  FILES: 'files',\n  AVATARS: 'avatars'\n};\n\n// User roles\nconst ROLES = {\n  RECRUITER: 'recruiter',\n  APPLICANT: 'applicant',\n  ADMIN: 'admin'\n};\n\n// Database operations\nconst db = {\n  // User operations\n  async createUser(userData) {\n    try {\n      // Use the",
        "startLine": 33,
        "endLine": 57
      },
      {
        "text": "rations\nconst db = {\n  // User operations\n  async createUser(userData) {\n    try {\n      // Use the admin client to bypass RLS for user creation\n      const { data, error } = await supabaseAdmin\n        .from(TABLES.USERS)\n        .insert([userData])\n        .select()\n        .single();\n      \n      if (error) throw error;\n      return { success: true, data };\n    } catch (error) {\n      logger.er",
        "startLine": 52,
        "endLine": 67
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/routes/authRoutes.js",
    "symbols": [],
    "snippet": "const express = require('express');\nconst router = express.Router();\n// const rateLimit = require('express-rate-limit');\nconst { \n  register, \n  login, \n  logout, \n  getCurrentUser, \n  updateProfile,\n  requestPasswordReset,\n  resetPassword\n} = require('../controllers/authController');\nconst { \n  validateAuthRegistration, \n  validateAuthLogin, \n  handleValidationErrors \n} = require('../middleware/v",
    "snippetStartLine": 1,
    "snippetEndLine": 17,
    "chunks": [
      {
        "text": "const express = require('express');\nconst router = express.Router();\n// const rateLimit = require('express-rate-limit');\nconst { \n  register, \n  login, \n  logout, \n  getCurrentUser, \n  updateProfile,\n  requestPasswordReset,\n  resetPassword\n} = require('../controllers/authController');\nconst { \n  validateAuthRegistration, \n  validateAuthLogin, \n  handleValidationErrors \n} = require('../middleware/v",
        "startLine": 1,
        "endLine": 17
      },
      {
        "text": "idateAuthRegistration, \n  validateAuthLogin, \n  handleValidationErrors \n} = require('../middleware/validation');\nconst { authenticateToken } = require('../middleware/auth');\n\n// Rate limiting for auth routes\n// const authLimiter = rateLimit({\n//   windowMs: 15 * 60 * 1000, // 15 minutes\n//   max: 100, // limit each IP to 100 requests per windowMs (increased for development)\n//   message: {\n//",
        "startLine": 14,
        "endLine": 25
      },
      {
        "text": "0, // limit each IP to 100 requests per windowMs (increased for development)\n//   message: {\n//     success: false,\n//     error: {\n//       message: 'Too many authentication attempts, please try again later.'\n//     }\n//   },\n//   standardHeaders: true,\n//   legacyHeaders: false,\n// });\n\n// Apply rate limiting to auth routes (disabled for development)\n// router.use(authLimiter);\n\n// Authenticatio",
        "startLine": 23,
        "endLine": 37
      },
      {
        "text": "ate limiting to auth routes (disabled for development)\n// router.use(authLimiter);\n\n// Authentication endpoints\nrouter.post('/register', validateAuthRegistration, handleValidationErrors, register);\nrouter.post('/login', validateAuthLogin, handleValidationErrors, login);\nrouter.post('/logout', logout);\nrouter.get('/me', authenticateToken, getCurrentUser);\nrouter.put('/profile', authenticateToken, u",
        "startLine": 34,
        "endLine": 42
      },
      {
        "text": ");\nrouter.get('/me', authenticateToken, getCurrentUser);\nrouter.put('/profile', authenticateToken, updateProfile);\n\n// Password reset endpoints\nrouter.post('/password/reset-request', requestPasswordReset);\nrouter.post('/password/reset', resetPassword);\n\nmodule.exports = router;",
        "startLine": 40,
        "endLine": 48
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/DEPLOYMENT_CHECKLIST.md",
    "symbols": [],
    "snippet": "# Deployment Readiness Checklist\n\n## ‚úÖ Completed\n\n### Code Migration\n- ‚úÖ Database client migrated to PostgreSQL (`utils/databaseClient.js`)\n- ‚úÖ Storage client migrated to DigitalOcean Spaces (`utils/storageClient.js`)\n- ‚úÖ Authentication migrated to custom JWT + bcrypt\n- ‚úÖ All controllers updated to use new clients\n- ‚úÖ Password reset functionality added for migrated users\n- ‚úÖ Dependencies updated (",
    "snippetStartLine": 1,
    "snippetEndLine": 11,
    "chunks": [
      {
        "text": "# Deployment Readiness Checklist\n\n## ‚úÖ Completed\n\n### Code Migration\n- ‚úÖ Database client migrated to PostgreSQL (`utils/databaseClient.js`)\n- ‚úÖ Storage client migrated to DigitalOcean Spaces (`utils/storageClient.js`)\n- ‚úÖ Authentication migrated to custom JWT + bcrypt\n- ‚úÖ All controllers updated to use new clients\n- ‚úÖ Password reset functionality added for migrated users\n- ‚úÖ Dependencies updated (",
        "startLine": 1,
        "endLine": 11
      },
      {
        "text": "use new clients\n- ‚úÖ Password reset functionality added for migrated users\n- ‚úÖ Dependencies updated (removed `@supabase/supabase-js`, added `pg`, `aws-sdk`)\n\n### Database\n- ‚úÖ Database migrations completed\n- ‚úÖ All tables created\n- ‚úÖ Data imported (users, companies, jobs, chat_history)\n- ‚úÖ Password hash column added\n\n### Testing\n- ‚úÖ Server starts successfully\n- ‚úÖ Database connection working\n- ‚úÖ User",
        "startLine": 9,
        "endLine": 22
      },
      {
        "text": "h column added\n\n### Testing\n- ‚úÖ Server starts successfully\n- ‚úÖ Database connection working\n- ‚úÖ User registration working\n- ‚úÖ User login working\n- ‚úÖ Password reset working\n- ‚úÖ JWT authentication working\n- ‚úÖ API endpoints responding\n\n## ‚ö†Ô∏è Before Deployment - Action Required\n\n### 1. Environment Variables\nMake sure all these are set in DigitalOcean App Platform:\n\n**Required:**\n- ‚úÖ `DATABASE_URL` - Po",
        "startLine": 17,
        "endLine": 34
      },
      {
        "text": "les\nMake sure all these are set in DigitalOcean App Platform:\n\n**Required:**\n- ‚úÖ `DATABASE_URL` - PostgreSQL connection string\n- ‚ö†Ô∏è `SPACES_KEY` - DigitalOcean Spaces access key\n- ‚ö†Ô∏è `SPACES_SECRET` - DigitalOcean Spaces secret key\n- ‚ö†Ô∏è `SPACES_ENDPOINT` - Spaces endpoint URL\n- ‚ö†Ô∏è `SPACES_BUCKET` - Spaces bucket name (or remove if using separate buckets)\n- ‚ö†Ô∏è `SPACES_REGION` - Spaces region\n- ‚ö†Ô∏è `",
        "startLine": 30,
        "endLine": 40
      },
      {
        "text": "Spaces bucket name (or remove if using separate buckets)\n- ‚ö†Ô∏è `SPACES_REGION` - Spaces region\n- ‚ö†Ô∏è `JWT_SECRET` - Strong secret key for JWT signing\n- ‚ö†Ô∏è `OPENAI_API_KEY` - If using OpenAI for AI features\n- ‚ö†Ô∏è `FRONTEND_URL` - Your frontend URL for CORS\n\n**Optional:**\n- `NODE_ENV=production`\n- `PORT=3001`\n- `LOG_LEVEL=info`\n\n### 2. Clean Up Old Files (Optional)\nThese files are no longer needed but",
        "startLine": 38,
        "endLine": 50
      }
    ]
  },
  {
    "uri": "/Users/Hazeem1/Desktop/ai-recruiter-backend/DEPLOYMENT_READY.md",
    "symbols": [],
    "snippet": "# Deployment Readiness Assessment\n\n## ‚úÖ Ready for Deployment: **ALMOST** (95% Ready)\n\n### What's Working ‚úÖ\n\n1. **Database Migration** - ‚úÖ Complete\n   - PostgreSQL connected and working\n   - All migrations run successfully\n   - Data imported (users, companies, jobs, chat_history)\n\n2. **Authentication** - ‚úÖ Complete\n   - Custom JWT authentication working\n   - Password reset for migrated users workin",
    "snippetStartLine": 1,
    "snippetEndLine": 14,
    "chunks": [
      {
        "text": "# Deployment Readiness Assessment\n\n## ‚úÖ Ready for Deployment: **ALMOST** (95% Ready)\n\n### What's Working ‚úÖ\n\n1. **Database Migration** - ‚úÖ Complete\n   - PostgreSQL connected and working\n   - All migrations run successfully\n   - Data imported (users, companies, jobs, chat_history)\n\n2. **Authentication** - ‚úÖ Complete\n   - Custom JWT authentication working\n   - Password reset for migrated users workin",
        "startLine": 1,
        "endLine": 14
      },
      {
        "text": "** - ‚úÖ Complete\n   - Custom JWT authentication working\n   - Password reset for migrated users working\n   - User registration/login tested and working\n\n3. **API Endpoints** - ‚úÖ Working\n   - All endpoints responding\n   - Health check working\n   - Authentication middleware working\n\n4. **Code Migration** - ‚úÖ Complete\n   - All controllers updated\n   - Database client working\n   - Storage client ready (",
        "startLine": 12,
        "endLine": 25
      },
      {
        "text": "* - ‚úÖ Complete\n   - All controllers updated\n   - Database client working\n   - Storage client ready (needs Spaces credentials)\n\n### What Needs Attention ‚ö†Ô∏è\n\n1. **Environment Variables** - ‚ö†Ô∏è Need to Set\n   - [ ] `SPACES_KEY` - DigitalOcean Spaces access key\n   - [ ] `SPACES_SECRET` - DigitalOcean Spaces secret key\n   - [ ] `SPACES_ENDPOINT` - e.g., `https://nyc3.digitaloceanspaces.com`\n   - [ ] `SP",
        "startLine": 22,
        "endLine": 33
      },
      {
        "text": "ces secret key\n   - [ ] `SPACES_ENDPOINT` - e.g., `https://nyc3.digitaloceanspaces.com`\n   - [ ] `SPACES_BUCKET` - Your bucket name (or remove if using separate buckets)\n   - [ ] `SPACES_REGION` - e.g., `nyc3`\n   - [ ] `JWT_SECRET` - Strong secret (change from default)\n   - [ ] `FRONTEND_URL` - Your frontend domain for CORS\n\n2. **DigitalOcean Spaces** - ‚ö†Ô∏è Need to Set Up\n   - [ ] Create 3 buckets:",
        "startLine": 31,
        "endLine": 39
      },
      {
        "text": "frontend domain for CORS\n\n2. **DigitalOcean Spaces** - ‚ö†Ô∏è Need to Set Up\n   - [ ] Create 3 buckets: `resumes`, `files`, `avatars`\n   - [ ] Generate access keys\n   - [ ] Test file upload/download\n\n3. **Deployment Config** - ‚ö†Ô∏è Need to Update\n   - [ ] Update `.do/app.yaml` with your GitHub repo name\n   - [ ] Verify all environment variables in config\n\n4. **File Migration** - ‚ö†Ô∏è Optional (Can do lat",
        "startLine": 36,
        "endLine": 47
      }
    ]
  }
]